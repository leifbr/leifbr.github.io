<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Section 2 - Identify and Resolve Application Issues</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Section 2 - Identify and Resolve Application Issues"/>
  <meta name="product" content="Unofficial - F5 Certification Exam Prep Material"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2020-08-13 09:31:44"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="Unofficial - F5 Certification Exam Prep Material" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Section 2 - Identify and Resolve Application Issues &#8212; Unofficial - F5 Certification Exam Prep Material  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5_agility_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/CoveoFullSearch.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Section 3 - Identify and Resolve LTM Device Issues" href="module3.html" />
    <link rel="prev" title="F5 301b Introduction" href="module1.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>Unofficial - F5 Certification Exam Prep Material  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Intro:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Getting Started with the F5 Certification Program 03/29/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 101 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class1/class1.html">F5 101 - App Delivery Fundamentals Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 201 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class2/class2.html">F5 201 - TMOS Administration Study Guide 11/01/19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">F5 201 - TMOS Administration Labs 08/11/2020</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 202 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">F5 202 - Pre-Sales Fundamentals Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 301A Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class5/class5.html">F5 301A - BIG-IP LTM Specialist: Architect, Set-Up &amp; Deploy Study Guide 11/01/19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class6/class6.html">F5 301A - BIG-IP LTM Specialist Labs 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 301B Certification Exam Resources:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../class7.html">F5 301B - BIG-IP LTM Specialist: Maintain and Troubleshoot Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 302 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class9/class9.html">F5 302 - BIG-IP DNS Specialist Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 303 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class11/class11.html">F5 303 - BIG-IP ASM Specialist Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 304 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class13/class13.html">F5 304 - BIG-IP APM Specialist Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 401 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class15/class15.html">F5 401 - Security Solution Expert Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 402 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class17/class17.html">F5 402 - Cloud Solutions Study Guide 11/01/19</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Section 2 - Identify and Resolve Application Issues</a><ul>
<li><a class="reference internal" href="#objective-2-01-determine-which-irule-to-use-to-resolve-an-application-issue">Objective - 2.01 Determine which iRule to use to resolve an application issue</a></li>
<li><a class="reference internal" href="#objective-2-02-explain-the-functionality-of-a-given-irule">Objective - 2.02 Explain the functionality of a given iRule</a></li>
<li><a class="reference internal" href="#wrapping-it-up">Wrapping it up</a></li>
<li><a class="reference internal" href="#objective-2-03-given-specific-traffic-and-configuration-containing-a-simple-irule-determine-the-result-of-the-irule-on-the-traffic">Objective - 2.03 Given specific traffic and configuration containing a simple iRule determine the result of the iRule on the traffic</a></li>
<li><a class="reference internal" href="#objective-2-04-interpret-avr-information-to-identify-performance-issues-or-application-attacks">Objective - 2.04 Interpret AVR information to identify performance issues or application attacks</a></li>
<li><a class="reference internal" href="#objective-2-05-interpret-avr-information-to-identify-ltm-device-misconfiguration">Objective - 2.05 Interpret AVR information to identify LTM device misconfiguration</a></li>
<li><a class="reference internal" href="#objective-2-06-given-a-set-of-headers-or-traces-determine-the-root-cause-of-an-http-https-application-problem">Objective - 2.06 Given a set of headers or traces, determine the root cause of an HTTP/HTTPS application problem</a></li>
<li><a class="reference internal" href="#objective-2-07-given-a-set-of-headers-or-traces-determine-a-solution-to-an-http-https-application-problem">Objective - 2.07 Given a set of headers or traces, determine a solution to an HTTP/HTTPS application problem</a></li>
<li><a class="reference internal" href="#objective-2-08-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-the-root-cause-of-an-http-https-application-problem">Objective - 2.08 Given a direct trace, a trace through the LTM device, and other relevant information, compare the traces to determine the root cause of an HTTP/HTTPS application problem</a></li>
<li><a class="reference internal" href="#objective-2-09-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-a-solution-to-an-http-https-application-problem">Objective - 2.09 Given a direct trace, a trace through the LTM device, and other relevant information, compare the traces to determine a solution to an HTTP/HTTPS application problem</a></li>
<li><a class="reference internal" href="#objective-2-10-given-a-scenario-determine-which-protocol-analyzer-tool-and-its-options-are-required-to-resolve-an-application-issue">Objective - 2.10 Given a scenario, determine which protocol analyzer tool and its options are required to resolve an application issue</a></li>
<li><a class="reference internal" href="#objective-2-11-given-a-trace-and-necessary-supporting-documentation-determine-the-root-cause-of-an-application-problem">Objective - 2.11 Given a trace and necessary supporting documentation, determine the root cause of an application problem</a></li>
<li><a class="reference internal" href="#objective-2-12-given-a-trace-and-necessary-supporting-documentation-determine-a-solution-to-an-application-problem">Objective - 2.12 Given a trace and necessary supporting documentation, determine a solution to an application problem</a></li>
<li><a class="reference internal" href="#objective-2-13-given-a-scenario-determine-from-where-the-protocol-analyzer-data-should-be-collected">Objective - 2.13 Given a scenario, determine from where the protocol analyzer data should be collected</a></li>
<li><a class="reference internal" href="#objective-2-14-given-a-trace-identify-monitor-issues">Objective - 2.14 Given a trace, identify monitor issues</a></li>
<li><a class="reference internal" href="#objective-2-15-given-a-monitor-issue-determine-an-appropriate-solution">Objective - 2.15 Given a monitor issue, determine an appropriate solution</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">Unofficial - F5 Certification Exam Prep Material</a>
              &gt; <a href="../class7.html">F5 301B - BIG-IP LTM Specialist: Maintain and Troubleshoot Study Guide 11/01/19</a>

          <span class="right">
             <a href="../../_sources/class7/modules/module2.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/leifbr/f5-agility-labs-cert">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="section-2-identify-and-resolve-application-issues">
<h1>Section 2 - Identify and Resolve Application Issues<a class="headerlink" href="#section-2-identify-and-resolve-application-issues" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="section" id="objective-2-01-determine-which-irule-to-use-to-resolve-an-application-issue">
<h2>Objective - 2.01 Determine which iRule to use to resolve an application issue<a class="headerlink" href="#objective-2-01-determine-which-irule-to-use-to-resolve-an-application-issue" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.01 - Determine which iRule events and commands to use</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-0/18.html">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-0/18.html</a></p>
<p><strong>iRule Events and Commands</strong></p>
<p>An iRule is a powerful and flexible feature within the BIG-IP operating
system that you can use to manage your network traffic. The iRules
feature not only allows you to select pools based on header data, but
also allows you to direct traffic by searching on any type of content
data that you define. Thus, the iRules feature significantly enhances
your ability to customize your content switching to suit your exact
needs.</p>
<p>Important: For complete and detailed information on iRules syntax, see
the F5 DevCentral web site, <a class="reference external" href="http://devcentral.f5.com">http://devcentral.f5.com</a>. Note that
iRules must conform to standard Tcl grammar rules; therefore, for more
information on Tcl syntax, see
<a class="reference external" href="http://tmml.sourceforge.net/doc/tcl/index.html">http://tmml.sourceforge.net/doc/tcl/index.html</a>.</p>
<p>An iRule is a script that you write if you want individual connections
to target a pool other than the default pool defined for a virtual
server. iRules allow you to more directly specify the destinations to
which you want traffic to be directed. Using iRules, you can send
traffic not only to pools, but also to individual pool members, ports,
or URIs. The iRules you create can be simple or sophisticated, depending
on your content-switching needs.</p>
<p>Events</p>
<p>iRules are event-driven, which means that the LTM system triggers an
iRule based on an event that you specify in the iRule. An event
declaration is the specification of an event within an iRule that causes
the LTM system to trigger that iRule whenever that event occurs.</p>
<p>In a basic system configuration where no iRule exists, Local Traffic
Manager directs incoming traffic to the default pool assigned to the
virtual server that receives that traffic. However, you might want Local
Traffic Manager to direct certain kinds of connections to other
destinations. The way to do this is to write an iRule that directs
traffic to that other destination, contingent on a certain type of event
occurring. Otherwise, traffic continues to go to the default pool
assigned to the virtual server.</p>
<p>iRules are therefore evaluated whenever an event occurs that you have
specified in the iRule. For example, if an iRule includes the event
declaration CLIENT_ACCEPTED, then the iRule is triggered whenever Local
Traffic Manager accepts a client connection. Local Traffic Manager then
follows the directions in the remainder of the iRule to determine the
destination of the packet.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>when CLIENT<span class="se">\_</span>ACCEPTED <span class="o">{</span>
  <span class="k">if</span> <span class="o">{</span> <span class="o">[</span>IP::addr <span class="o">[</span>IP::client<span class="se">\_</span>addr<span class="o">]</span> equals <span class="m">10</span>.10.10.10<span class="o">]</span> <span class="o">}</span> <span class="o">{</span>
    pool my<span class="se">\_</span>pool
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This iRule is triggered when a client-side connection has been accepted,
causing Local Traffic Manager to send the packet to the pool my_pool,
if the client’s address matches 10.10.10.10.</p>
<p>For a full list of possible events see the following link:</p>
<p><a class="reference external" href="https://devcentral.f5.com/wiki/irules.Events.ashx">https://devcentral.f5.com/wiki/irules.Events.ashx</a></p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.01 - Given a specific iRule event determine what commands are available</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-0/18.html">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-0/18.html</a></p>
<p><strong>iRule Commands</strong></p>
<p>An iRule command within an iRule causes Local Traffic Manager to take
some action, such as querying for data, manipulating data, or specifying
a traffic destination. The types of commands that you can include within
iRules are:</p>
<p>Statement commands</p>
<p>These commands cause actions such as selecting a traffic destination or
assigning a SNAT translation address. An example of a statement command
is pool &lt;name&gt;, which directs traffic to the named load balancing pool.</p>
<p>Commands that query or manipulate data</p>
<p>Some commands search for header and content data, while others perform
data manipulation such as inserting headers into HTTP requests. An
example of a query command is IP::remote_addr, which searches for and
returns the remote IP address of a connection. An example of a data
manipulation command is HTTP::header remove &lt;name&gt;, which removes the
last occurrence of the named header from a request or response.</p>
<p>Utility commands</p>
<p>These commands are functions that are useful for parsing and
manipulating content. An example of a utility command is decode_uri
&lt;string&gt;, which decodes the named string using HTTP URI encoding and
returns the result.</p>
<p>For a full list of possible commands see the following link:</p>
<p><a class="reference external" href="https://devcentral.f5.com/wiki/iRules.Commands.ashx">https://devcentral.f5.com/wiki/iRules.Commands.ashx</a></p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-02-explain-the-functionality-of-a-given-irule">
<h2>Objective - 2.02 Explain the functionality of a given iRule<a class="headerlink" href="#objective-2-02-explain-the-functionality-of-a-given-irule" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.02 - Interpret information in iRule logs to determine the iRule and iRule events where they occurred</strong></p>
<p><a class="reference external" href="https://devcentral.f5.com/articles/irules-101-09-debugging">https://devcentral.f5.com/articles/irules-101-09-debugging</a></p>
<p><strong>Logging with iRules</strong></p>
<p>The first tool you will want to arm yourself with is the iRules “log” command.
The syntax for the log is</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>log <span class="o">[</span>&lt;facility&gt;.&lt;level&gt;<span class="o">]</span> &lt;message&gt;
facility : <span class="s2">&quot;local0&quot;</span>, <span class="s2">&quot;local1&quot;</span>, <span class="s2">&quot;local2&quot;</span>, <span class="s2">&quot;local3&quot;</span>, <span class="s2">&quot;local4&quot;</span>, <span class="s2">&quot;local5&quot;</span>,
<span class="s2">&quot;local6&quot;</span>, <span class="s2">&quot;local7&quot;</span>
level: <span class="s2">&quot;alert&quot;</span>, <span class="s2">&quot;crit&quot;</span>, <span class="s2">&quot;debug&quot;</span>, <span class="s2">&quot;emerg&quot;</span>, <span class="s2">&quot;err&quot;</span>, <span class="s2">&quot;error&quot;</span>, <span class="s2">&quot;info&quot;</span>,
<span class="s2">&quot;none&quot;</span>, <span class="s2">&quot;notice&quot;</span>, <span class="s2">&quot;panic&quot;</span>, <span class="s2">&quot;warn&quot;</span>, <span class="s2">&quot;warning&quot;</span>
</pre></div>
</div>
<p>While the facility and level parameters are optional, it is good to know
that there is a significant behavioral difference when the optional
&lt;facility&gt;.&lt;level&gt; is specified. When iRule logs messages without the
facility and/or level, they are rate-limited as a class and subsequently
logged messages within the rate-limit period may be suppressed even
though they are textually different. However, when the &lt;facility&gt; and/or
&lt;level&gt; are specified, the log messages are not rate-limited (though
syslog-ng will still perform suppression of repeated duplicates).</p>
<p>Whew, that’s a lot of options. Lucky for you all that unless you are
doing some customization in syslog-ng regarding the different facilities
and levels, you can stick with the defaults of “local0” and “error”
which are the defaults. Actually, we’ve made it even easier than that
for you, in that you can omit the level parameter and we’ll default it
for you. In almost every iRule you will see on DevCentral, the following
syntax is used and in 99% of the cases, it will be all that you need.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>log local0. <span class="s2">&quot;message goes here&quot;</span>
</pre></div>
</div>
<p>This will ensure that the log messages are not rate limited and go
directly to the log files and that they will be stored in the system log
file: /var/log/ltm.</p>
<p>A practical example</p>
<p>What and what not to log really depends on your iRule and what you are
trying to accomplish with it. If you are trying to process a HTTP
request, it’s probably a good idea to log the inputs to your iRule such
as <a class="reference external" href="HTTP::host">HTTP::host</a> and <a class="reference external" href="HTTP::uri">HTTP::uri</a>, as well as any temporary variables you are
using if processing those string values. Let’s look at the following iRule.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>when HTTP<span class="se">\_</span>REQUEST <span class="o">{</span>
  switch -glob <span class="o">[</span>HTTP::uri<span class="o">]</span> <span class="o">{</span>
    <span class="s2">&quot;/app1\*&quot;</span> <span class="o">{</span>
      pool app1<span class="se">\_</span>pool
    <span class="o">}</span>
    <span class="s2">&quot;\*.gif&quot;</span> -
    <span class="s2">&quot;\*.jpg&quot;</span> <span class="o">{</span>
      pool images<span class="se">\_</span>pool
    <span class="o">}</span>
    default <span class="o">{</span>
      pool def<span class="se">\_</span>pool
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>This seems fairly straight forward. All requests to the “/app1”
application will be sent to the app1_pool pool, all files with the
“.gif” and “.jpg” extensions will be routed to the images_pool pool,
and all other requests will be sent to the def_pool pool. Then you go
to test your application and none of the images for the app1 application
are being displayed. The way to go about debugging this issue would be
to log the inputs and log the decision elements of the iRules logic to
determine the source of the problem.</p>
<p>Your first thought is to go to the webserver logs for the image servers
and see why the requests are not being honored. To your surpise, the
logs show no requests on the image servers. Your next obvious step is to
put some debugging in your iRule to see exactly what’s going on.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>when HTTP<span class="se">\_</span>REQUEST <span class="o">{</span>
  log local0. <span class="s2">&quot;Request: [HTTP::uri]&quot;</span>
  switch -glob <span class="o">[</span>HTTP::uri<span class="o">]</span> <span class="o">{</span>
    <span class="s2">&quot;/app1\*&quot;</span> <span class="o">{</span>
      log local0. <span class="s2">&quot;Sending request to app1\_pool&quot;</span>
      pool app1<span class="se">\_</span>pool
    <span class="o">}</span>
    <span class="s2">&quot;\*.gif&quot;</span> -
    <span class="s2">&quot;\*.jpg&quot;</span> <span class="o">{</span>
      log local0. <span class="s2">&quot;Sending request to images\_pool&quot;</span>
      pool images<span class="se">\_</span>pool
    <span class="o">}</span>
    default <span class="o">{</span>
      log local0. <span class="s2">&quot;Sending request to def\_pool&quot;</span>
      pool def<span class="se">\_</span>pool
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Then when you run your traffic, you will see something like this in the
logs</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Request: /app1/index.html
Sending request to app1<span class="se">\_</span>pool
Request: /js/file.js
Sending request to def<span class="se">\_</span>pool
Request: /app1/smile.gif
Sending request to app1<span class="se">\_</span>pool
</pre></div>
</div>
<p>What! I thought all image files were supposed to be sent to the
images_pool pool but they are being sent to the app1_pool pool. Since
the condition of searching for “/app1” was before the “gif/”jpg” test,
it matched and requests were sent to the app1_pool pool of servers. Now
that you have this information, it’s fairly easy to reorder the
conditions in the switch statement to ensure all image request go to the
images_pool pool.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>when HTTP<span class="se">\_</span>REQUEST <span class="o">{</span>
  log local0. <span class="s2">&quot;Request: [HTTP::uri]&quot;</span>
  switch -glob <span class="o">[</span>HTTP::uri<span class="o">]</span> <span class="o">{</span>
    <span class="s2">&quot;\*.gif&quot;</span> -
    <span class="s2">&quot;\*.jpg&quot;</span> <span class="o">{</span>
      log local0. <span class="s2">&quot;Sending request to images\_pool&quot;</span>
      pool images<span class="se">\_</span>pool
    <span class="o">}</span>
    <span class="s2">&quot;/app1\*&quot;</span> <span class="o">{</span>
      log local0. <span class="s2">&quot;Sending request to app1\_pool&quot;</span>
      pool app1<span class="se">\_</span>pool
    <span class="o">}</span>
    default <span class="o">{</span>
      log local0. <span class="s2">&quot;Sending request to def\_pool&quot;</span>
      pool def<span class="se">\_</span>pool
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Now to your pleasure, the images are displaying in your application.
Just for kicks you look at the logs and see something like the
following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Request: /app1/index.html
Sending request to app1<span class="se">\_</span>pool
Request: /js/file.js
Sending request to def<span class="se">\_</span>pool
Request: /app1/smile.gif
Sending request to images<span class="se">\_</span>poo
</pre></div>
</div>
<p>All is good, the app is working, and all images are being displayed
properly. You’re done right? WRONG…</p>
<p><strong>Remove Logging in Production</strong></p>
<p>Debug logging is a great tool when testing your application deployments,
or even when fixing an issue with production servers. But, log messages
do fill up the system logs and the system disks are only so big. In most
cases, debug logging should be disabled when you’ve got all the kinks
worked out. This can be done in several ways:</p>
<ol class="arabic">
<li><p class="first">Remove the log commands from the iRule. This is probably the easiest
to implement, just delete the log lines and click save. This option
will reduce the clutter in your iRule and makes it easier to read.</p>
</li>
<li><p class="first">Comment out the log commands with a # sign. This will enable you to
easily restore the log commands if another situation comes up where
you need to figure out a new app error. Just uncomment the log lines,
click save, and you are back in business.</p>
</li>
<li><p class="first">Use conditional log statements based on global variables. By wrapping
log statements with an if statement testing the value of a variable,
you can make turning on and off logging as simple as changing a
variable. The above iRule could be written like this.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>when HTTP<span class="se">\_</span>REQUEST <span class="o">{</span>
  <span class="nb">set</span> DEBUG <span class="m">1</span>
  <span class="k">if</span> <span class="o">{</span> <span class="nv">$DEBUG</span> <span class="o">}</span> <span class="o">{</span> log local0. <span class="s2">&quot;Request: [HTTP::uri]&quot;</span> <span class="o">}</span>
  switch -glob <span class="o">[</span>HTTP::uri<span class="o">]</span> <span class="o">{</span>
    <span class="s2">&quot;\*.gif&quot;</span> -
    <span class="s2">&quot;\*.jpg&quot;</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">{</span> <span class="nv">$DEBUG</span> <span class="o">}</span> <span class="o">{</span> log local0. <span class="s2">&quot;Sending request to images\_pool&quot;</span>
      <span class="o">}</span>
      pool images<span class="se">\_</span>pool
    <span class="o">}</span>
    <span class="s2">&quot;/app1\*&quot;</span> <span class="o">{</span>
      <span class="k">if</span> <span class="o">{</span> <span class="nv">$DEBUG</span> <span class="o">}</span> <span class="o">{</span> log local0. <span class="s2">&quot;Sending request to app1\_pool&quot;</span> <span class="o">}</span>
      pool app1<span class="se">\_</span>pool
    <span class="o">}</span>
    default <span class="o">{</span>
      <span class="k">if</span> <span class="o">{</span> <span class="nv">$DEBUG</span> <span class="o">}</span> <span class="o">{</span> log local0. <span class="s2">&quot;Sending request to def\_pool&quot;</span> <span class="o">}</span>
      pool def<span class="se">\_</span>pool
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Then by setting DEBUG to 1 will enable logging and setting it to 0 will
turn logging off. The method you use will solely depend on your own
situation. Options 1 and 2 take no CPU overhead in the log processing,
while option 3 still requires performing a Boolean test on a variable.
For hundreds of thousands of requests, this can add up.</p>
</li>
</ol>
</div>
<div class="section" id="wrapping-it-up">
<h2>Wrapping it up<a class="headerlink" href="#wrapping-it-up" title="Permalink to this headline">¶</a></h2>
<p>First thing to know and imprint in your mind is that logging is your
friend. You should get in the habit of including some form of logging in
all new iRule development to speed up diagnosing issues. Just make sure
that you remember to disable those log commands when you move your iRule
into production so that you keep from filling up the BIG-IP’s
filesystem.</p>
<p>For more information on the log command see the following link:</p>
<p><a class="reference external" href="https://devcentral.f5.com/wiki/iRules.log.ashx">https://devcentral.f5.com/wiki/iRules.log.ashx</a></p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.02 - Describe the results of iRule errors</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/13000/900/sol13905.html?sr=46137011">https://support.f5.com/kb/en-us/solutions/public/13000/900/sol13905.html?sr=46137011</a></p>
<p><strong>iRule Errors</strong></p>
<p>When an iRule contains an error, such as a missing variable, the system
generates a TCL error indicating the missing or incorrect element. A TCL
runtime error aborts the affected instance of the iRule, and may cause
the associated connection to be reset. The error message can provide
valuable information when creating and troubleshooting iRule syntax.</p>
<p>If the error message occurs during operation or while creating an iRule,
use the information in the error message to troubleshoot the iRule
syntax. If the error occurs after upgrading the BIG-IP system to a new
software release, refer to the DevCentral site and verify whether any
portion of the iRule syntax (such as an iRule command) was deprecated or
changed.</p>
<p><strong>Error Message</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">*Error Message: 01220001:3: TCL error*</span>
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">*01220001:3: TCL error: /Common/broken &lt;RULE\_INIT&gt; - can&#39;t read &quot;b&quot;: no</span>
<span class="go">such variable while executing &quot;set a $b&quot;*</span>
<span class="go">*01220001:3: TCL error: MyiRule &lt;HTTP\_RESPONSE&gt; - wrong # args: should</span>
<span class="go">be &quot;&quot;persist add uie &lt;key&gt;&quot; while executing &quot;persist add uie</span>
<span class="go">[HTTP::cookie &quot;cookie\_name&quot;]&quot; *</span>
<span class="go">*01220001:3: TCL error: MyiRule - Out of bounds (line 2) invoked from</span>
<span class="go">within &quot;HTTP::payload replace 0 $content\_length [string repeat &quot;X&quot;</span>
<span class="gp">$</span>content<span class="se">\_</span>length<span class="o">]</span><span class="s2">&quot;*</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-03-given-specific-traffic-and-configuration-containing-a-simple-irule-determine-the-result-of-the-irule-on-the-traffic">
<h2>Objective - 2.03 Given specific traffic and configuration containing a simple iRule determine the result of the iRule on the traffic<a class="headerlink" href="#objective-2-03-given-specific-traffic-and-configuration-containing-a-simple-irule-determine-the-result-of-the-irule-on-the-traffic" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.03 - Use an iRule to resolve application issues related to traffic steering and/or application data</strong></p>
<p><a class="reference external" href="https://devcentral.f5.com/articles/routing-traffic-by-uri-using-irule">https://devcentral.f5.com/articles/routing-traffic-by-uri-using-irule</a></p>
<p><strong>Routing traffic by URI using iRule</strong></p>
<p>DevCentral has a good article on this topic as an example.</p>
<p>The Challenge:</p>
<p>When a user conducts a search on a website and is directed to one of the
servers, the search information is cached on that server. If another
user searches for that same data but the LTM load balances to the other
server, the cached data from the first server does him no good. So to
solve this caching problem, the customer wants traffic that contains a
specific search parameter to be routed to the second server (as long as
the server is available). Specifically in this case, when a user loads a
page and the URI starts with /path/* that traffic should be sent to
Server_2.</p>
<p>The picture below shows a representation of what the customer wants to
accomplish:</p>
<img alt="../../_images/p09.jpeg" src="../../_images/p09.jpeg" />
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p>The Solution:</p>
<p>So, the question becomes: How does the customer ensure all /path/*
traffic is sent to a specific server? Well, you guessed it…the
ubiquitous and loveable iRule! Everyone had a pretty good idea an iRule
would be used to solve this problem, but what does that iRule look like?
Well, here it is!!</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>when HTTP<span class="se">\_</span>REQUEST <span class="o">{</span>
  <span class="k">if</span> <span class="o">{</span> <span class="o">[</span>string tolower <span class="o">[</span>HTTP::path<span class="o">]]</span> starts<span class="se">\_</span>with <span class="s2">&quot;/path/&quot;</span> <span class="o">}</span> <span class="o">{</span>
    persist none
    <span class="nb">set</span> pm <span class="o">[</span>lsearch -inline <span class="o">[</span>active<span class="se">\_</span>members -list &lt;pool name&gt;<span class="o">]</span>
    x.x.x.x<span class="se">\*</span><span class="o">]</span>
    catch <span class="o">{</span> pool &lt;pool name&gt; member <span class="o">[</span>lindex <span class="nv">$pm</span> <span class="m">0</span><span class="o">]</span> <span class="o">[</span>lindex <span class="nv">$pm</span> <span class="m">1</span><span class="o">]</span> <span class="o">}</span>
  <span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Let’s talk through the specifics of this solution…</p>
<p>For efficiency, start by checking the least likely condition. If an
HTTP_REQUEST comes in, immediately check for the “/path/” string. Keep
in mind the “string tolower” command on the <a class="reference external" href="HTTP::path">HTTP::path</a> before the
comparison to “/path/” to ensure the cases match correctly. Also, notice
the use of <a class="reference external" href="HTTP::path">HTTP::path</a> instead of the full URI for the
comparison…there’s no need to use the full URI for this check.</p>
<p>Next, turn off persistence just in case another profile or iRule is
forcing the connection to persist to a place other than the beloved
Server_2.</p>
<p>Then, search all active members in the pool for the Server_2 IP address
and port. The “lsearch -inline” ensures the matching value is returned
instead of just the index. The “active_members -list” is used to ensure
we get a list of IP addresses and ports, not just the number of active
members. Note the asterisk behind the IP address in the search
command…this is needed to ensure the port number is included in the
search. Based on the searches, the resulting values are set in a
variable called “pm”.</p>
<p>Next, use the catch command to stop any TCL errors from causing
problems. Because we are getting the active members list, it’s possible
that the pool member we are trying to match is NOT active and therefore
the pool member listed in the pool command may not be there…this is
what might cause that TCL error. Then send the traffic to the correct
pool member, which requires the IP and port. The astute observer and
especially the one familiar with the output of “active_members -list”
will notice that each pool member returned in the list is already
pre-formatted in “ip port” format. However, just using the pm variable
in the pool command returns a TCL error, likely because the pm variable
is a single object instead of two unique objects. So, the lindex is used
to pull out each element individually to avoid the TCL error.</p>
<p>Testing:</p>
<p>Our team tested the iRule by adding it to a development site and then
accessing several pages on that site. We made sure the pages included
“/path/” in the URIs! We used tcpdump on the BIG-IP to capture the
transactions (tcpdump -ni 0.0 -w/var/tmp/capture1.pcap tcp port 80 -s0)
and then downloaded them locally and used Wireshark for analysis. Using
these tools, we determined that all the “/path/” traffic routed to
Server_2 and all other traffic was still balanced between Server_1 and
Server_2. So, the iRule worked correctly and it was ready for prime
time!</p>
<p>Special thanks to Jason Rahm and Joe Pruitt for their outstanding
technical expertise and support in solving this challenge!</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-04-interpret-avr-information-to-identify-performance-issues-or-application-attacks">
<h2>Objective - 2.04 Interpret AVR information to identify performance issues or application attacks<a class="headerlink" href="#objective-2-04-interpret-avr-information-to-identify-performance-issues-or-application-attacks" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.04 - Explain how to modify profile settings using information from the AVR</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/4.html#conceptid">https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/4.html#conceptid</a></p>
<p><strong>Changing the default values in the Analytics profile</strong></p>
<p>Reported information that is captured by AVR can be used to help you
understand what is happening with the application and possible tune
settings in the BIG-IP configuration.</p>
<p>You may have users experiencing slow Page Load Times which is the length
of time it takes for application web pages to load on client-side
browsers. This information is useful if end users report that an
application is slow, and you want to determine the cause of the problem.
Adjusting the TCP profile to account for Cell or WAN based users on the
client side may help improve the issue or understanding that the content
is large and perhaps doing some simple compression may help the user
experience.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.04 - Explain how to use advanced filters to narrow output data from AVR</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/2.html#conceptid">https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/2.html#conceptid</a></p>
<p>You can review charts that show statistical information about traffic to
your web applications. The charts provide visibility into application
behavior, user experience, transactions, and data center resource usage.</p>
<ol class="arabic">
<li><p class="first">On the Main tab, click Statistics &gt; Analytics &gt; HTTP. The Overview
screen opens.</p>
</li>
<li><p class="first">From the Override time range to list, select a new time frame to
apply to all of the widgets in the overview.</p>
<p>Tip: Within each widget you can override the default time range, as
needed.</p>
</li>
<li><p class="first">For each widget, select the data format and the time range to
display, as needed.</p>
</li>
<li><p class="first">From the menu bar, select the type of statistics you want to view.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Select this option</th>
<th class="head">To see these application statistics</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Overview</td>
<td>Top statistical information about traffic on your system or managed systems, such as the top virtual servers, top URLs accessed, and top applications. You can customize the information that is displayed.</td>
</tr>
<tr class="row-odd"><td>Transactions</td>
<td>The HTTP transaction rate (transactions per second) passing through the web applications, and the number of transactions to and from the web applications.</td>
</tr>
<tr class="row-even"><td>Latency &gt; Server Latency</td>
<td>The number of milliseconds it takes from the time a request arrives at the virtual server until a response arrives at the virtual server.</td>
</tr>
<tr class="row-odd"><td>Latency &gt; Page Load Time</td>
<td>The number of milliseconds it takes for a web page to fully load on a client browser, from the time the user clicks a link or enters a web address until the web page displays in its entirety.</td>
</tr>
<tr class="row-even"><td>Throughput &gt; Request Throughput</td>
<td>HTTP request throughput in bits per second.</td>
</tr>
<tr class="row-odd"><td>Throughput &gt; Response Throughput</td>
<td>HTTP response throughput in bits per second.</td>
</tr>
<tr class="row-even"><td>Sessions &gt; New Sessions</td>
<td>The number of transactions that open new sessions, in sessions per second.</td>
</tr>
<tr class="row-odd"><td>Sessions &gt; Concurrent Sessions</td>
<td>The total number of open and active sessions at a given time, until they time out.</td>
</tr>
</tbody>
</table>
<p>The charts display information based on the settings you enabled in the Analytics profile.</p>
</li>
<li><p class="first">From the View By list, select the specific network object type for
which you want to display statistics. You can also click Expand
Advanced Filters to filter the information that displays.</p>
</li>
<li><p class="first">To focus in on the specific details you want more information about,
click the chart or the details. The system refreshes the charts and
displays information about the item.</p>
</li>
<li><p class="first">On the screen, the system displays the path you followed to reach the
current display, including the items you clicked. For example, to
review throughput details for a particular virtual server, follow
these steps:</p>
<ul>
<li><p class="first">From the Throughput menu, choose Request Throughput.</p>
</li>
<li><p class="first">From the View By list, select Virtual Servers. The charts show
throughput statistics for all virtual servers on this BIG-IP system.
You can point on the charts to display specific numbers.</p>
</li>
<li><p class="first">Click the virtual server you want more information about. You can
either click a part of the pie chart or click the name of the virtual
server in the Details table. The charts show throughput statistics
for that virtual server, and shows the path you used to display the
information.</p>
</li>
<li><p class="first">To view information about other applications or retrace your path,
click a link (in blue) in the path displayed by the charts.</p>
<p>As you drill down into the statistics, you can locate more details
and view information about a specific item on the charts.</p>
</li>
</ul>
</li>
</ol>
<p>You can continue to review the collected metrics on the system viewing
transactions, latency, throughput, and sessions. As a result, you become
more familiar with the system, applications, resource utilization, and
more, and you can view the statistics in clear graphical charts, and
troubleshoot the system as needed.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.04 - Identify potential latency increases within an application</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/3.html#conceptid">https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/3.html#conceptid</a></p>
<p><strong>Investigating the server latency of applications</strong></p>
<p>You can review statistics concerning server latency on the Analytics
charts. Server latency is how long it takes (in milliseconds) from the
time a request reaches the BIG-IP system, for it to proceed to the web
application server, and return a response to the BIG-IP system.</p>
<ol class="arabic simple">
<li>On the Main tab, click Statistics &gt; Analytics &gt; HTTP. The Overview
screen opens.</li>
<li>From the Latency menu, choose Server Latency. A chart shows the
server latency for all applications and virtual servers associated
with all Analytics profiles.</li>
<li>To view server latency for a specific application, in the Details
table, select only that application. The charts show latency only for
the selected application.</li>
<li>To view server latency for a specific virtual server:<ul>
<li>In the View By list, select Virtual Servers. The charts show latency
for all virtual servers.</li>
<li>In the Details list near the charts, click the virtual server you are
interested in. The charts show latency only for the selected virtual
server.</li>
</ul>
</li>
<li>If further investigation is needed, in the View By setting, select
other entities to view charts that show latency for other collected
entities included in the Analytics profile, for example, specific
pool members, URLs, countries, or client IP addresses.</li>
</ol>
<p>Tip: If you are concerned about server latency, you can configure the
Analytics profile so that it sends an alert when the average server
latency exceeds a number of milliseconds for some period of time.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-05-interpret-avr-information-to-identify-ltm-device-misconfiguration">
<h2>Objective - 2.05 Interpret AVR information to identify LTM device misconfiguration<a class="headerlink" href="#objective-2-05-interpret-avr-information-to-identify-ltm-device-misconfiguration" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.05 - Explain how to use AVR to trace application traffic</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0.pdf">https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0.pdf</a></p>
<p><strong>AVR to trace application traffic</strong></p>
<p>This implementation describes how to set up the BIG-IP system to collect
application traffic so that you can troubleshoot problems that have
become apparent by monitoring application statistics. For example, by
examining captured requests and responses, you can investigate issues
with latency, throughput, or reduced transactions per second to
understand what is affecting application performance.</p>
<p>When Application Visibility and Reporting (AVR) is provisioned, you can
create an Analytics profile that includes traffic capturing
instructions. The system can collect application traffic locally,
remotely, or both. If the system is already monitoring applications, you
can also update an existing Analytics profile to make it so that it
captures traffic.</p>
<p>If logging locally, the system logs the first 1000 transactions and
displays charts based on the analysis of those transactions. If logging
remotely, the system logs information on that system; log size is
limited only by any constraints of the remote logging system. To see
updated application statistics, you can clear the existing data to
display the current statistics.</p>
<p><strong>Prerequisites for capturing application traffic</strong></p>
<p>After you finish a basic networking configuration of the BIG-IP system,
you must complete the following tasks as prerequisites for setting up
application statistics collection:</p>
<ul class="simple">
<li>Provision Application Visibility and Reporting (AVR): System &gt;
Resource Provisioning</li>
<li>Create an iAppsTM application service (go to iApp &gt; Application
Services), or configure at least one virtual server with a pool
pointing to one or more application servers.</li>
<li>The Traffic Sampling Ratio must be set to all in the default
Analytics profile.</li>
</ul>
<p>You can set up the system for capturing traffic locally or remotely (or
both).</p>
<p>Tip: Before setting up traffic capturing, it is a good idea to
clear the captured transaction log. On the Captured Transactions
screen, click Clear All to clear all previously captured data
records.</p>
<p><strong>Capturing traffic for troubleshooting</strong></p>
<p>To set up traffic capturing, the Transaction Sampling Ratio of the
default analytics profile must be set to All.</p>
<p>You can configure the BIG-IP system to capture application traffic and
store the information locally or remotely (on syslog servers or SIEM
devices, such as Splunk). To do this, you create an Analytics profile
designed for capturing traffic. The profile instructs the BIG-IP system
to collect a portion of application traffic using the Application
Visibility and Reporting module.</p>
<p>Note: You typically use traffic capturing if you notice an
application issue, such as trouble with throughput or latency,
discovered when examining application statistics, and want to
troubleshoot the system by examining actual transactions.</p>
<ol class="arabic">
<li><p class="first">On the Main tab, click Local Traffic &gt; Profiles &gt; Analytics.</p>
<p>Tip: If Analytics is not listed, this indicates that Application
Visibility and Reporting (AVR) is not provisioned, or you do not
have rights to create profiles.</p>
<p>The Analytics screen opens and lists all Analytics profiles that are
on the system, including a default profile called analytics.</p>
</li>
<li><p class="first">Click Create.</p>
<p>The New Analytics Profile screen opens. By default, the settings are
initially the same as in the default analytics profile.</p>
</li>
<li><p class="first">In the Profile Name field, type a name for the Analytics profile.</p>
</li>
<li><p class="first">To the right of the General Configuration area, click the Custom
check box.</p>
<p>The settings in the area become available for modification.</p>
</li>
<li><p class="first">For Traffic Capturing Logging Type, specify where to store captured
traffic.</p>
<ul class="simple">
<li>To store traffic locally, click Internal. You can view details on the
Statistics: Captured Transactions screen. This option is selected by
default.</li>
<li>To store traffic on a remote logging server, click External and type
the Remote Server IP Address and Remote Server Port number.</li>
</ul>
<p>Tip: If you specify remote logging for multiple applications,
you can use the Remote Server Facility filter to sort the data for
each.</p>
</li>
<li><p class="first">In the Included Objects area, specify the virtual servers for which
to capture application statistics:</p>
<ul>
<li><p class="first">For the Virtual Servers setting, click Add.</p>
<p>A popup lists the virtual servers that you can assign to the
Analytics profile.</p>
</li>
<li><p class="first">From the Select Virtual Server popup list, select the virtual servers
to include and click Done.</p>
<p>Note: You need to have previously configured the virtual servers
(with an HTTP profile) for them to appear in the list. Also, you can
assign only one Analytics profile to a virtual server so the list
shows only virtual servers that have not been assigned an Analytics
profile.</p>
<p>Special considerations apply if using Analytics on a BIG-IP system
with both Application Security ManagerTM and Access Policy
ManagerTM, where security settings (in Portal Access WebTop or an
iRule) redirect traffic from one virtual server to a second one. In
this case, you need to attach the Analytics profile to the second
virtual server to ensure that the charts show accurate statistics.</p>
</li>
</ul>
</li>
<li><p class="first">In the Statistics Gathering Configuration, for Collected Metrics,
select the statistics you want the system to collect:</p>
<table border="1" class="docutils">
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Server Latency</td>
<td>Tracks how long it takes to get data from the application server to the BIG-IP system (selected by default).</td>
</tr>
<tr class="row-odd"><td>Page Load Time</td>
<td><p class="first">Tracks how long it takes an application user to get a complete response from the application, including network latency and completed page processing.</p>
<p class="last"><strong>Note:</strong> End user response times and latencies can vary significantly based on geography and connection types.</p>
</td>
</tr>
<tr class="row-even"><td>Throughput</td>
<td>Saves information about HTTP request and response throughput (selected by default).</td>
</tr>
<tr class="row-odd"><td>User Sessions</td>
<td>Stores the number of unique user sessions. For Timeout, type the number of minutes of user non-activity to allow before the system considers the session to be over. If using transaction sampling, this option is not available.</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">For Collected Entities, select the entities for which you want the system to collect statistics:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>URLs</td>
<td>Collects the requested URLs.</td>
</tr>
<tr class="row-odd"><td>Countries</td>
<td>Saves the name of the country where the request came from based on the client IP address.</td>
</tr>
<tr class="row-even"><td>Client IP Addresses</td>
<td>Saves the IP address where the request originated. The address saved also depends on whether the request has an XFF (X-forwarded-for) header and whether Trust XFF is selected.</td>
</tr>
<tr class="row-odd"><td>Response Codes</td>
<td>Saves HTTP response codes that the server returned to requesters (selected by default).</td>
</tr>
<tr class="row-even"><td>User Agents</td>
<td>Saves information about browsers used when making the request.</td>
</tr>
<tr class="row-odd"><td>Methods</td>
<td>Saves HTTP methods in requests (selected by default).</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">In the Capture Filter area, from the Capture Requests and Capture
Responses lists, select the options that indicate the part of the
traffic to capture.</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>None</td>
<td>Specifies that the system does not capture request (or response) data.</td>
</tr>
<tr class="row-odd"><td>Headers</td>
<td>Specifies that the system captures request (or response) header data only.</td>
</tr>
<tr class="row-even"><td>Body</td>
<td>Specifies that the system captures the body of requests (or responses) only.</td>
</tr>
<tr class="row-odd"><td>All</td>
<td>Specifies that the system captures all request (or response) data.</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">Depending on the application, customize the remaining filter settings
to capture the portion of traffic to that you need for
troubleshooting.</p>
<p>Tip: By focusing in on the data and limiting the type of
information that is captured, you can troubleshoot particular areas
of an application more quickly. For example, capture only requests
or responses, specific status codes or methods, or headers
containing a specific string.</p>
</li>
<li><p class="first">Click Finished.</p>
</li>
</ol>
<p>The BIG-IP system captures the application traffic described by the
Analytics profile for 1000 transactions locally (or until system limits
are reached). If logging remotely, the system logs information on that
system; log size is limited only by constraints of the remote logging
system.</p>
<p>Note: System performance is affected when traffic is being captured.</p>
<p><strong>Reviewing captured traffic</strong></p>
<p>Before you can review captured traffic details on the BIG-IP system, you
need to have created an Analytics profile that is capturing application
traffic locally. The settings you enable in the Capture Filter area of
the profile determine what information the system captures. You need to
associate the Analytics profile with one or more virtual servers, or
with an iApps application service.</p>
<p>The system starts capturing application traffic as soon as you enable it
on the Analytics profile. You can review the captured transactions
locally on the BIG-IP system. The system logs the first 1000
transactions.</p>
<ol class="arabic">
<li><p class="first">On the Main tab, click System &gt; Logs &gt; Captured Transactions.</p>
<p>The Captured Transactions screen opens and lists all of the captured
transactions.</p>
</li>
<li><p class="first">Optionally, use the time period and filter settings to limit which
transactions are listed.</p>
</li>
<li><p class="first">In the Captured Traffic area, click any transaction that you want to
examine.</p>
<p>Details of the request will display on the screen.</p>
</li>
<li><p class="first">Review the general details of the request.</p>
<p>Tip: The general details, such as the response code or the size
of the request and response, help with troubleshooting.</p>
</li>
<li><p class="first">For more information, click Request or Response to view the contents
of the actual transaction. Review the data for anything unexpected,
and other details that will help with troubleshooting the
application.</p>
</li>
<li><p class="first">On the Captured Transactions screen, click Clear All to clear all
previously captured data records (including those not displayed on
the screen) and start collecting transactions again.</p>
<p>The system captures up to 1000 transactions locally and displays
them on the screen. Captured transactions are visible a few seconds
after they occur.</p>
</li>
</ol>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.05 - Explain how latency trends identify application tier bottlenecks</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/3.html#conceptid">https://support.f5.com/kb/en-us/products/big-ip_analytics/manuals/product/avr-implementations-11-5-0/3.html#conceptid</a></p>
<p>Latency is a classic network performance metric, which at the basic
level requires the evaluation of timestamps applied to the same packet
as it passes through two locations in the network. By comparing the
timestamps, the latency of the network segment can be monitored. Many
networked applications and services rely on low latency in order to
function correctly.</p>
<p>If you have established latency times for transport traffic in your
network and you are seeing latency grow or exceed a threshold that
causes user acceptance to drop for an application, you can use it as a
basis to look into changes or setting that may be causing additional
latency. Gathering the information and keep track of changes is the key
to identifying application tier issues.</p>
<p><strong>Investigating the server latency of applications</strong></p>
<p>Before you can investigate server latency, you need to have created an
Analytics profile that is logging statistics internally on the BIG-IP
system. The Analytics profile must be associated with one or more
virtual servers, or an iApps application service. If your browser is IE8
or earlier, you need to have Adobe Flash Player installed on the
computer from which you plan to review the data.</p>
<p>Note: Newer browsers (Internet Explorer 9 or later, Firefox 3.6 or
later, or Chrome 14 or later) support viewing Analytics charts with no
additional plug-in. If using older browsers (Internet Explorer 8 or
earlier, Firefox 3.5 or earlier, or Chrome 13 or earlier), Adobe Flash
Player (version 8 or later) must be installed on the computer where you
plan to view Analytics charts.</p>
<p>You can review statistics concerning server latency on the Analytics
charts. Server latency is how long it takes (in milliseconds) from the
time a request reaches the BIG-IP system, for it to proceed to the web
application server, and return a response to the BIG-IP system.</p>
<ol class="arabic simple">
<li>On the Main tab, click Statistics &gt; Analytics &gt; HTTP. The Overview
screen opens.</li>
<li>From the Latency menu, click Server Latency. A chart shows the server
latency for all applications and virtual servers associated with all
Analytics profiles.</li>
<li>To view server latency for a specific application, in the Details
table, select only that application. The charts show latency only for
the selected application.</li>
<li>To view server latency for a specific virtual server:<ul>
<li>In the View By list, select Virtual Servers. The charts show latency
for all virtual servers.</li>
<li>In the Details list near the charts, click the virtual server you are
interested in. The charts show latency only for the selected virtual
server.</li>
</ul>
</li>
<li>If further investigation is needed, in the View By setting, select
other entities to view charts that show latency for other collected
entities included in the Analytics profile, for example, specific
pool members, URLs, countries, or client IP addresses.</li>
</ol>
<p>Tip: If you are concerned about server latency, you can configure
the Analytics profile so that it sends an alert when the average server
latency exceeds a number of milliseconds for some period of time.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-06-given-a-set-of-headers-or-traces-determine-the-root-cause-of-an-http-https-application-problem">
<h2>Objective - 2.06 Given a set of headers or traces, determine the root cause of an HTTP/HTTPS application problem<a class="headerlink" href="#objective-2-06-given-a-set-of-headers-or-traces-determine-the-root-cause-of-an-http-https-application-problem" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.06 - Explain how to interpret response codes</strong></p>
<p><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a></p>
<p><strong>Response Codes</strong></p>
<p>The Status-Code element is a 3-digit integer result code of the attempt
to understand and satisfy the request. The Reason-Phrase is intended to
give a short textual description of the Status-Code. The Status-Code is
intended for use by automata and the Reason-Phrase is intended for the
human user. The client is not required to examine or display the Reason-
Phrase.</p>
<p>The first digit of the Status-Code defines the class of response. The
last two digits do not have any categorization role. There are 5 values
for the first digit:</p>
<ul class="simple">
<li>1xx: Informational - Request received, continuing process</li>
<li>2xx: Success - The action was successfully received, understood, and
accepted</li>
<li>3xx: Redirection - Further action must be taken in order to complete
the request</li>
<li>4xx: Client Error - The request contains bad syntax or cannot be
fulfilled</li>
<li>5xx: Server Error - The server failed to fulfill an apparently valid
request</li>
</ul>
<p><strong>Status Code Definitions</strong></p>
<p>Each Status-Code is described below, including a description of which
method(s) it can follow and any meta information required in the
response.</p>
<p><strong>Informational 1xx</strong></p>
<p>This class of status code indicates a provisional response, consisting
only of the Status-Line and optional headers, and is terminated by an
empty line. There are no required headers for this class of status code.
Since HTTP/1.0 did not define any 1xx status codes, servers must not
send a 1xx response to an HTTP/1.0 client except under experimental
conditions.</p>
<p>A client must be prepared to accept one or more 1xx status responses
prior to a regular response, even if the client does not expect a 100
(Continue) status message. A user agent MAY ignore an unexpected 1xx
status response.</p>
<p>Proxies must forward 1xx responses, unless the connection between the
proxy and its client has been closed, or unless the proxy itself
requested the generation of the 1xx response. (For example, if a proxy
adds a “Expect: 100-continue” field when it forwards a request, then it
need not forward the corresponding 100 (Continue) response(s).)</p>
<p><strong>100 Continue</strong></p>
<p>The client should continue with its request. This interim response is
used to inform the client that the initial part of the request has been
received and has not yet been rejected by the server. The client should
continue by sending the remainder of the request or, if the request has
already been completed, ignore this response. The server must send a
final response after the request has been completed.</p>
<p><strong>101 Switching Protocols</strong></p>
<p>The server understands and is willing to comply with the client’s
request, via the Upgrade message header field, for a change in the
application protocol being used on this connection. The server will
switch protocols to those defined by the response’s Upgrade header field
immediately after the empty line, which terminates the 101 response.</p>
<p>The protocol should be switched only when it is advantageous to do so.
For example, switching to a newer version of HTTP is advantageous over
older versions, and switching to a real-time, synchronous protocol might
be advantageous when delivering resources that use such features.</p>
<p><strong>Successful 2xx</strong></p>
<p>This class of status code indicates that the client’s request was
successfully received, understood, and accepted.</p>
<p><strong>200 OK</strong></p>
<p>The request has succeeded. The information returned with the response is
dependent on the method used in the request, for example:</p>
<p><strong>GET</strong> an entity corresponding to the requested resource is sent in the
response;</p>
<p><strong>HEAD</strong> the entity-header fields corresponding to the requested
resource are sent in the response without any message-body;</p>
<p><strong>POST</strong> an entity describing or containing the result of the action;</p>
<p><strong>TRACE</strong> an entity containing the request message as received by the
end server.</p>
<p><strong>201 Created</strong></p>
<p>The request has been fulfilled and resulted in a new resource being
created. The newly created resource can be referenced by the URI(s)
returned in the entity of the response, with the most specific URI for
the resource given by a Location header field. The response should
include an entity containing a list of resource characteristics and
location(s) from which the user or user agent can choose the one most
appropriate. The media type given in the Content-Type header field
specifies the entity format. The origin server must create the resource
before returning the 201 status code. If the action cannot be carried
out immediately, the server should respond with 202 (Accepted) response
instead.</p>
<p>A 201 response may contain an ETag response header field indicating the
current value of the entity tag for the requested variant just created.</p>
<p><strong>202 Accepted</strong></p>
<p>The request has been accepted for processing, but the processing has not
been completed. The request might or might not eventually be acted upon,
as it might be disallowed when processing actually takes place. There is
no facility for re-sending a status code from an asynchronous operation
such as this.</p>
<p>The 202 response is intentionally non-committal. Its purpose is to allow
a server to accept a request for some other process (perhaps a
batch-oriented process that is only run once per day) without requiring
that the user agent’s connection to the server persist until the process
is completed. The entity returned with this response should include an
indication of the request’s current status and either a pointer to a
status monitor or some estimate of when the user can expect the request
to be fulfilled.</p>
<p><strong>203 Non-Authoritative Information</strong></p>
<p>The returned metainformation in the entity-header is not the definitive
set as available from the origin server, but is gathered from a local or
a third-party copy. The set presented may be a subset or superset of the
original version. For example, including local annotation information
about the resource might result in a superset of the metainformation
known by the origin server. Use of this response code is not required
and is only appropriate when the response would otherwise be 200 (OK).</p>
<p><strong>204 No Content</strong></p>
<p>The server has fulfilled the request but does not need to return an
entity-body, and might want to return updated metainformation. The
response may include new or updated metainformation in the form of
entity-headers, which if present should be associated with the requested
variant.</p>
<p>If the client is a user agent, it should not change its document view
from that which caused the request to be sent. This response is
primarily intended to allow input for actions to take place without
causing a change to the user agent’s active document view, although any
new or updated metainformation should be applied to the document
currently in the user agent’s active view.</p>
<p>The 204 response must not include a message-body, and thus is always
terminated by the first empty line after the header fields.</p>
<p><strong>205 Reset Content</strong></p>
<p>The server has fulfilled the request and the user agent should reset the
document view, which caused the request to be sent. This response is
primarily intended to allow input for actions to take place via user
input, followed by a clearing of the form in which the input is given so
that the user can easily initiate another input action. The response
must not include an entity.</p>
<p><strong>206 Partial Content</strong></p>
<p>The server has fulfilled the partial GET request for the resource. The
request must have included a Range header field indicating the desired
range, and may have included an If-Range header field to make the
request conditional.</p>
<p>The response must include the following header fields:</p>
<ul class="simple">
<li>Either a Content-Range header field indicating the range included
with this response, or a multipart/byteranges Content-Type including
Content-Range fields for each part. If a Content-Length header field
is present in the response, its value must match the actual number of
OCTETs transmitted in the message-body.</li>
<li>Date</li>
<li>ETag and/or Content-Location, if the header would have been sent in a
200 response to the same request</li>
<li>Expires, Cache-Control, and/or Vary, if the field-value might differ
from that sent in any previous response for the same variant</li>
</ul>
<p>If the 206 response is the result of an If-Range request that used a
strong cache validator, the response should not include other
entity-headers. If the response is the result of an If-Range request
that used a weak validator, the response must not include other
entity-headers; this prevents inconsistencies between cached
entity-bodies and updated headers. Otherwise, the response must include
all of the entity-headers that would have been returned with a 200 (OK)
response to the same request.</p>
<p>A cache must not combine a 206 response with other previously cached
content if the ETag or Last-Modified headers do not match exactly.</p>
<p>A cache that does not support the Range and Content-Range headers must
not cache 206 (Partial) responses.</p>
<p><strong>Redirection 3xx</strong></p>
<p>This class of status code indicates that further action needs to be
taken by the user agent in order to fulfill the request. The user agent
may carry out the action required without interaction with the user if
and only if the method used in the second request is GET or HEAD. A
client should detect infinite redirection loops, since such loops
generate network traffic for each redirection.</p>
<p>Note: previous versions of this specification recommended a
maximum of five redirections. Content developers should be aware
that there might be clients that implement such a fixed limitation.</p>
<p><strong>300 Multiple Choices</strong></p>
<p>The requested resource corresponds to any one of a set of
representations, each with its own specific location, and agent- driven
negotiation information is being provided so that the user (or user
agent) can select a preferred representation and redirect its request to
that location.</p>
<p>Unless it was a HEAD request, the response should include an entity
containing a list of resource characteristics and location(s) from which
the user or user agent can choose the one most appropriate. The media
type given in the Content-Type header field specifies the entity format.
Depending upon the format and the capabilities of the user agent,
selection of the most appropriate choice may be performed automatically.
However, this specification does not define any standard for such
automatic selection.</p>
<p>If the server has a preferred choice of representation, it should
include the specific URI for that representation in the Location field;
user agents may use the Location field value for automatic redirection.
This response is cacheable unless indicated otherwise.</p>
<p><strong>301 Moved Permanently</strong></p>
<p>The requested resource has been assigned a new permanent URI and any
future references to this resource should use one of the returned URIs.
Clients with link editing capabilities ought to automatically re-link
references to the Request-URI to one or more of the new references
returned by the server, where possible. This response is cacheable
unless indicated otherwise.</p>
<p>The Location field in the response should give the new permanent URI.
Unless the request method was HEAD, the entity of the response should
contain a short hypertext note with a hyperlink to the new URI(s).</p>
<p>If the 301 status code is received in response to a request other than
GET or HEAD, the user agent must not automatically redirect the request
unless it can be confirmed by the user, since this might change the
conditions under which the request was issued.</p>
<p>Note: When automatically redirecting a POST request after
receiving a 301 status code, some existing HTTP/1.0 user agents will
erroneously change it into a GET request.</p>
<p><strong>302 Found</strong></p>
<p>The requested resource resides temporarily under a different URI. Since
the redirection might be altered on occasion, the client should continue
to use the Request-URI for future requests. This response is only
cacheable if indicated by a Cache-Control or Expires header field.</p>
<p>The temporary URI should be given by the Location field in the response.
Unless the request method was HEAD, the entity of the response should
contain a short hypertext note with a hyperlink to the new URI(s).</p>
<p>If the 302 status code is received in response to a request other than
GET or HEAD, the user agent must not automatically redirect the request
unless it can be confirmed by the user, since this might change the
conditions under which the request was issued.</p>
<p>Note: RFC 1945 and RFC 2068 specify that the client is not allowed to change the method
on the redirected request. However, most existing user agent implementations treat 302 as
if it were a 303 response, performing a GET on the Location field-value regardless of the
original request method. The status codes 303 and 307 have been added for servers that
wish to make unambiguously clear which kind of reaction is expected of the client.</p>
<p><strong>303 See Other</strong></p>
<p>The response to the request can be found under a different URI and
should be retrieved using a GET method on that resource. This method
exists primarily to allow the output of a POST-activated script to
redirect the user agent to a selected resource. The new URI is not a
substitute reference for the originally requested resource. The 303
response must not be cached, but the response to the second (redirected)
request might be cacheable.</p>
<p>The Location field in the response should give the different URI. Unless
the request method was HEAD, the entity of the response should contain a
short hypertext note with a hyperlink to the new URI(s).</p>
<p>Note: Many pre-HTTP/1.1 user agents do not understand the 303
status. When interoperability with such clients is a concern, the
302 status code may be used instead, since most user agents react to
a 302 response as described here for 303.</p>
<p><strong>304 Not Modified</strong></p>
<p>If the client has performed a conditional GET request and access is
allowed, but the document has not been modified, the server should
respond with this status code. The 304 response must not contain a
message-body, and thus is always terminated by the first empty line
after the header fields.</p>
<p>The response must include the following header fields:</p>
<ul>
<li><p class="first">Date, unless its omission is required</p>
<p>If a clockless origin server obeys these rules, and proxies and
clients add their own Date to any response received without one (as
already specified by RFC 2068), caches will operate correctly.</p>
</li>
<li><p class="first">ETag and/or Content-Location, if the header would have been sent in a
200 response to the same request</p>
</li>
<li><p class="first">Expires, Cache-Control, and/or Vary, if the field-value might differ
from that sent in any previous response for the same variant</p>
</li>
</ul>
<p>If the conditional GET used a strong cache validator, the response
should not include other entity-headers. Otherwise (i.e., the
conditional GET used a weak validator), the response must not include
other entity-headers; this prevents inconsistencies between cached
entity-bodies and updated headers.</p>
<p>If a 304 response indicates an entity not currently cached, then the
cache must disregard the response and repeat the request without the
conditional.</p>
<p>If a cache uses a received 304 response to update a cache entry, the
cache must update the entry to reflect any new field values given in the
response.</p>
<p><strong>305 Use Proxy</strong></p>
<p>The requested resource must be accessed through the proxy given by the
Location field. The Location field gives the URI of the proxy. The
recipient is expected to repeat this single request via the proxy. 305
responses must only be generated by origin servers.</p>
<p>Note: RFC 2068 was not clear that 305 was intended to redirect a
single request, and to be generated by origin servers only. Not
observing these limitations has significant security consequences.</p>
<p><strong>306 (Unused)</strong></p>
<p>The 306 status code was used in a previous version of the specification,
is no longer used, and the code is reserved.</p>
<p><strong>307 Temporary Redirect</strong></p>
<p>The requested resource resides temporarily under a different URI. Since
the redirection may be altered on occasion, the client should continue
to use the Request-URI for future requests. This response is only
cacheable if indicated by a Cache-Control or Expires header field.</p>
<p>The temporary URI should be given by the Location field in the response.
Unless the request method was HEAD, the entity of the response should
contain a short hypertext note with a hyperlink to the new URI(s), since
many pre-HTTP/1.1 user agents do not understand the 307 status.
Therefore, the note should contain the information necessary for a user
to repeat the original request on the new URI.</p>
<p>If the 307 status code is received in response to a request other than
GET or HEAD, the user agent must not automatically redirect the request
unless it can be confirmed by the user, since this might change the
conditions under which the request was issued.</p>
<p><strong>Client Error 4xx</strong></p>
<p>The 4xx class of status code is intended for cases in which the client
seems to have erred. Except when responding to a HEAD request, the
server should include an entity containing an explanation of the error
situation, and whether it is a temporary or permanent condition. These
status codes are applicable to any request method. User agents should
display any included entity to the user.</p>
<p>If the client is sending data, a server implementation using TCP should
be careful to ensure that the client acknowledges receipt of the
packet(s) containing the response, before the server closes the input
connection. If the client continues sending data to the server after the
close, the server’s TCP stack will send a reset packet to the client,
which may erase the client’s unacknowledged input buffers before they
can be read and interpreted by the HTTP application.</p>
<p><strong>400 Bad Request</strong></p>
<p>The server due to malformed syntax could not understand the request. The
client should not repeat the request without modifications.</p>
<p><strong>401 Unauthorized</strong></p>
<p>The request requires user authentication. The response must include a
WWW-Authenticate header field containing a challenge applicable to the
requested resource. The client MAY repeat the request with a suitable
Authorization header field. If the request already included
Authorization credentials, then the 401 response indicates that
authorization has been refused for those credentials. If the 401
response contains the same challenge as the prior response, and the user
agent has already attempted authentication at least once, then the user
should be presented the entity that was given in the response, since
that entity might include relevant diagnostic information. HTTP access
authentication is explained in “HTTP Authentication: Basic and Digest
Access Authentication”.</p>
<p><strong>402 Payment Required</strong></p>
<p>This code is reserved for future use.</p>
<p><strong>403 Forbidden</strong></p>
<p>The server understood the request, but is refusing to fulfill it.
Authorization will not help and the request should not be repeated. If
the request method was not HEAD and the server wishes to make public why
the request has not been fulfilled, it should describe the reason for
the refusal in the entity. If the server does not wish to make this
information available to the client, the status code 404 (Not Found) can
be used instead.</p>
<p><strong>404 Not Found</strong></p>
<p>The server has not found anything matching the Request-URI. No
indication is given of whether the condition is temporary or permanent.
The 410 (Gone) status code should be used if the server knows, through
some internally configurable mechanism, that an old resource is
permanently unavailable and has no forwarding address. This status code
is commonly used when the server does not wish to reveal exactly why the
request has been refused, or when no other response is applicable.</p>
<p><strong>405 Method Not Allowed</strong></p>
<p>The method specified in the Request-Line is not allowed for the resource
identified by the Request-URI. The response must include an Allow header
containing a list of valid methods for the requested resource.</p>
<p><strong>406 Not Acceptable</strong></p>
<p>The resource identified by the request is only capable of generating
response entities which have content characteristics not acceptable
according to the accept headers sent in the request.</p>
<p>Unless it was a HEAD request, the response should include an entity
containing a list of available entity characteristics and location(s)
from which the user or user agent can choose the one most appropriate.
The media type given in the Content-Type header field specifies the
entity format. Depending upon the format and the capabilities of the
user agent, selection of the most appropriate choice MAY be performed
automatically. However, this specification does not define any standard
for such automatic selection.</p>
<p>Note: HTTP/1.1 servers are allowed to return responses which are
not acceptable according to the accept headers sent in the request.
In some cases, this may even be preferable to sending a 406
response. User agents are encouraged to inspect the headers of an
incoming response to determine if it is acceptable.</p>
<p>If the response could be unacceptable, a user agent should temporarily
stop receipt of more data and query the user for a decision on further
actions.</p>
<p><strong>407 Proxy Authentication Required</strong></p>
<p>This code is similar to 401 (Unauthorized), but indicates that the
client must first authenticate itself with the proxy. The proxy must
return a Proxy-Authenticate header field containing a challenge
applicable to the proxy for the requested resource. The client may
repeat the request with a suitable Proxy-Authorization header field.
HTTP access authentication is explained in “HTTP Authentication: Basic
and Digest Access Authentication”.</p>
<p><strong>408 Request Timeout</strong></p>
<p>The client did not produce a request within the time that the server was
prepared to wait. The client may repeat the request without
modifications at any later time.</p>
<p><strong>409 Conflict</strong></p>
<p>The request could not be completed due to a conflict with the current
state of the resource. This code is only allowed in situations where it
is expected that the user might be able to resolve the conflict and
resubmit the request. The response body should include enough
information for the user to recognize the source of the conflict.
Ideally, the response entity would include enough information for the
user or user agent to fix the problem; however, that might not be
possible and is not required.</p>
<p>Conflicts are most likely to occur in response to a PUT request. For
example, if versioning were being used and the entity being PUT included
changes to a resource which conflict with those made by an earlier
(third-party) request, the server might use the 409 response to indicate
that it can’t complete the request. In this case, the response entity
would likely contain a list of the differences between the two versions
in a format defined by the response Content-Type.</p>
<p><strong>410 Gone</strong></p>
<p>The requested resource is no longer available at the server and no
forwarding address is known. This condition is expected to be considered
permanent. Clients with link editing capabilities should delete
references to the Request-URI after user approval. If the server does
not know, or has no facility to determine, whether or not the condition
is permanent, the status code 404 (Not Found) should be used instead.
This response is cacheable unless indicated otherwise.</p>
<p>The 410 response is primarily intended to assist the task of web
maintenance by notifying the recipient that the resource is
intentionally unavailable and that the server owners desire that remote
links to that resource be removed. Such an event is common for
limited-time, promotional services and for resources belonging to
individuals no longer working at the server’s site. It is not necessary
to mark all permanently unavailable resources as “gone” or to keep the
mark for any length of time – that is left to the discretion of the
server owner.</p>
<p><strong>411 Length Required</strong></p>
<p>The server refuses to accept the request without a defined Content-
Length. The client may repeat the request if it adds a valid
Content-Length header field containing the length of the message-body in
the request message.</p>
<p><strong>412 Precondition Failed</strong></p>
<p>The precondition given in one or more of the request-header fields
evaluated to false when it was tested on the server. This response code
allows the client to place preconditions on the current resource
metainformation (header field data) and thus prevent the requested
method from being applied to a resource other than the one intended.</p>
<p><strong>413 Request Entity Too Large</strong></p>
<p>The server is refusing to process a request because the request entity
is larger than the server is willing or able to process. The server may
close the connection to prevent the client from continuing the request.</p>
<p>If the condition is temporary, the server should include a Retry-After
header field to indicate that it is temporary and after what time the
client may try again.</p>
<p><strong>414 Request-URI Too Long</strong></p>
<p>The server is refusing to service the request because the Request-URI is
longer than the server is willing to interpret. This rare condition is
only likely to occur when a client has improperly converted a POST
request to a GET request with long query information, when the client
has descended into a URI “black hole” of redirection (e.g., a redirected
URI prefix that points to a suffix of itself), or when the server is
under attack by a client attempting to exploit security holes present in
some servers using fixed-length buffers for reading or manipulating the
Request-URI.</p>
<p><strong>415 Unsupported Media Type</strong></p>
<p>The server is refusing to service the request because the entity of the
request is in a format not supported by the requested resource for the
requested method.</p>
<p><strong>416 Requested Range Not Satisfiable</strong></p>
<p>A server should return a response with this status code if a request
included a Range request-header field, and none of the range-specifier
values in this field overlap the current extent of the selected
resource, and the request did not include an If-Range request-header
field. (For byte-ranges, this means that the first- byte-pos of all of
the byte-range-spec values were greater than the current length of the
selected resource.)</p>
<p>When this status code is returned for a byte-range request, the response
should include a Content-Range entity-header field specifying the
current length of the selected resource. This response must not use the
multipart/byteranges content- type.</p>
<p><strong>417 Expectation Failed</strong></p>
<p>This server could not meet the expectation given in an Expect
request-header field, or, if the server is a proxy, the server has
unambiguous evidence that the next-hop server could not meet the
request.</p>
<p><strong>Server Error 5xx</strong></p>
<p>Response status codes beginning with the digit “5” indicate cases in
which the server is aware that it has erred or is incapable of
performing the request. Except when responding to a HEAD request, the
server should include an entity containing an explanation of the error
situation, and whether it is a temporary or permanent condition. User
agents should display any included entity to the user. These response
codes are applicable to any request method.</p>
<p><strong>500 Internal Server Error</strong></p>
<p>The server encountered an unexpected condition, which prevented it from
fulfilling the request.</p>
<p><strong>501 Not Implemented</strong></p>
<p>The server does not support the functionality required to fulfill the
request. This is the appropriate response when the server does not
recognize the request method and is not capable of supporting it for any
resource.</p>
<p><strong>502 Bad Gateway</strong></p>
<p>The server, while acting as a gateway or proxy, received an invalid
response from the upstream server it accessed in attempting to fulfill
the request.</p>
<p><strong>503 Service Unavailable</strong></p>
<p>The server is currently unable to handle the request due to a temporary
overloading or maintenance of the server. The implication is that this
is a temporary condition, which will be alleviated after some delay. If
known, the length of the delay may be indicated in a Retry-After header.
If no Retry-After is given, the client should handle the response as it
would for a 500 response.</p>
<p>Note: The existence of the 503 status code does not imply that a
server must use it when becoming overloaded. Some servers may wish
to simply refuse the connection.</p>
<p><strong>504 Gateway Timeout</strong></p>
<p>The server, while acting as a gateway or proxy, did not receive a timely
response from the upstream server specified by the URI (e.g. HTTP, FTP,
LDAP) or some other auxiliary server (e.g. DNS) it needed to access in
attempting to complete the request.</p>
<p>Note: Note to implementers: some deployed proxies are known to
return 400 or 500 when DNS lookups time out.</p>
<p><strong>505 HTTP Version Not Supported</strong></p>
<p>The server does not support, or refuses to support, the HTTP protocol
version that was used in the request message. The server is indicating
that it is unable or unwilling to complete the request using the same
major version as the client, as described in section 3.1, other than
with this error message. The response should contain an entity
describing why that version is not supported and what other protocols
that server supports.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.06 - Explain the function of HTTP headers within different HTTP applications (Cookies, Cache Control, Vary, Content Type &amp; Host)</strong></p>
<p><a class="reference external" href="https://f5.com/resources/white-papers/fundamentals-of-http">https://f5.com/resources/white-papers/fundamentals-of-http</a></p>
<p><strong>HTTP Headers</strong></p>
<p>HTTP headers carry information about behavior and application state
between the browser and the server. These headers can be modified and
examined by the browser and the server, as well as intermediary devices
such as web acceleration solutions and application delivery controllers.
The headers sent by the browser notify the web server of the browser’s
capabilities. The headers sent by the web server tell the browser how to
treat the content.</p>
<p>The most important browser headers, in terms of end-user performance,
are:</p>
<ol class="arabic simple">
<li>HTTP version (HTTP/1.0 or HTTP/1.1)</li>
<li>Accept-Encoding: gzip, deflate</li>
<li>Connection: Keep-Alive</li>
<li>If - * headers</li>
<li>Cache-Control or Pragma no-cache</li>
</ol>
<p>The first three items are interrelated. HTTP 1.0 does not include
compression–indicated by the Accept-Encoding: gzip, deflate header, or
connection keep-alives. Compression can reduce the byte count of text by
6:1 to 8:1. This often translates into a 40-50 percent reduction in size
for a page. Connection: Keep-Alive will reuse TCP connections for
subsequent requests and will save on the latency incurred by the 3-way
hand-shake, and 4-way tear-down required for TCP connections on every
request. Keeping connections open is important in emerging web-based
applications that utilize Web 2.0 technology such as AJAX (Asynchronous
JavaScript and XML) to perform real-time updates of content because it
reduces the overhead associated with opening and closing TCP
connections.</p>
<p>The various If-* headers, such as If-Modified-Since, will enable the
web server to send a response that indicates the content has not been
modified if this is true. This can potentially turn a 200KB download
into a 1KB download, as the browser will respond to the 304 Not Modified
response by loading the referenced content from the browser’s cache.
However, a lot of If-* requests for static content can result in
unnecessary round trips. This can really slow end-user performance. The
no-cache header and its relatives—no-store, private, must-revalidate,
and proxy-revalidate—request that proxies and, sometimes, web servers
not cache the response to the request. Honoring those requests can cause
the servers to do a lot more work because they must always return the
full content rather than enable the browser to use a cached version.</p>
<p>The most important web server headers, in terms of end-user performance,
are:</p>
<ol class="arabic simple">
<li>The HTTP version (either HTTP/1.0 or HTTP/1.1) at the beginning of
the status line</li>
<li>Connection: Keep-Alive/Close</li>
<li>Encoding: gzip, deflate</li>
<li>The various cache-control headers, especially max-age</li>
<li>Content-Type:</li>
<li>Date:</li>
<li>Accept-Ranges: bytes</li>
</ol>
<p>Again, the first three items are inter-related and are meant to impart
the same information as when sent by the browser. The cache-control
headers are very important because they can be used to store items in
the browser cache and avoid future HTTP requests altogether. However,
using cached data runs the risk of using out-dated data if the content
changes before the cached object expires. Content-type is important for
telling the browser how to handle the object. This is most important for
content that the browser hands off to plug-ins (Flash, Microsoft Office
documents, etc.). It is also the biggest clue to the true function of
that object in the web application. Improper content types will often
result in slower, but not broken web applications. The Date header is
very important because it affects how the browser interprets the
cache-control headers. It is important to make sure the date on the
server is set correctly so that this field is accurate. The
Accept-Ranges header is only important when downloading PDF documents.
It enables the browser to know that it can request the PDF document one
page at a time.</p>
<hr class="docutils" />
<p><a class="reference external" href="https://f5.com/resources/white-papers/fundamentals-of-http">https://f5.com/resources/white-papers/fundamentals-of-http</a></p>
<p><strong>Cookies</strong></p>
<p>Cookies are sent by the web server to the browser as an HTTP header and
used to store all sorts of information about a user’s interaction with
the site. Generally speaking the use of cookies will not affect the
performance of an application, unless they are encrypted for security
purposes. The reason encrypted cookies can affect performance is because
the web server needs to decrypt them before use, and the
encryption/decryption process is resource intensive. The more encrypted
cookies that are used by a site, the longer it takes for the web server
to process them into a readable format.</p>
<hr class="docutils" />
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/5000/100/sol5157.html?sr=46612722">https://support.f5.com/kb/en-us/solutions/public/5000/100/sol5157.html?sr=46612722</a></p>
<p><strong>Vary</strong></p>
<p>The HTTP Vary header, documented in RFC2616, is set by an origin web
server (OWS) and contains request-header information. This information
is used to determine whether a proxy server is permitted to reply to a
subsequent request without re-validating the content from the OWS.</p>
<p>The BIG-IP HTTP cache (referred to as RAM Cache in BIG-IP versions prior
to 11.0.0) uses the information from the Vary header to cache responses
from the OWS. The OWS can include information within the Vary header to
determine which resource the server returns in its response. For
example, if a page is optimized for a particular web browser, the OWS
response may return the Vary: User-Agent HTTP header. The proxy server
then uses this information to determine whether to return a cached copy
of the response to subsequent requests, or to query the OWS for the
resource again (a subsequent client request containing a different
User-Agent value forces the proxy to query the OWS for the resource
again).</p>
<p>This behavior can require a proxy server (including the BIG-IP HTTP
cache) to use up excess disk space to cache the same response.</p>
<p>For example:</p>
<p>Client A’s request for a URI contains the following header:</p>
<p>User-Agent: agent1</p>
<p>The server’s response includes the following headers:</p>
<p>Vary: User-Agent, Accept-Encoding</p>
<p>The BIG-IP system then stores the page, noting the User-Agent and
Accept-Encoding headers from the client’s request.</p>
<p>Client B then requests the same URI, but the request has a User-Agent
header containing agent2. The BIG-IP system ignores the existing cache
entry (since the User-Agent is different), forwards the request to the
server, and caches the response as a separate entry.</p>
<p>Beginning with BIG-IP 9.2, you can use the iRule CACHE::userkey
&lt;keystring&gt; command to instruct the cache to cache the information based
on the parameter that the administrator specifies. You can use this
command to prevent multiple caches of the same information.
Additionally, you can use the CACHE::useragent and CACHE::acceptencoding
commands to override the behavior described in the previous example,
such as, have a cache based on a group of User-Agent values rather than
store an entry for each User-Agent header seen, and cause duplication.</p>
<p>For example, the following iRule sets the cache behavior based on the
information that the User-Agent has on the customer’s initial request,
not on honoring User-Agent or Accept-Encoding when found in the server’s
Vary header:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>when HTTP<span class="se">\_</span>REQUEST <span class="o">{</span> <span class="nb">set</span> user<span class="se">\_</span>key <span class="s2">&quot;[HTTP::header User-Agent]&quot;</span>
CACHE::userkey <span class="nv">$user</span><span class="se">\_</span>key <span class="o">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The user_key can be defined as any string found in the HTTP
request that the administrator wants to use to build cache
responses.</p>
</div>
<p>You can use the previously listed iRule commands, even when the server
does not set a Vary header, which allows the administrator to control
the behavior outside of the server.</p>
<p><strong>Content-Type</strong></p>
<p>The MIME type of the body of the request (used with POST and PUT
requests)</p>
<p><strong>Host</strong></p>
<p>The host value is represented by the domain name of the server (for
virtual hosting), and the TCP port number on which the server is
listening. The port number may be omitted if the port is the standard
port for the service requested.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.06 - Explain HTTP methods (GET, POST, etc.)</strong></p>
<p><a class="reference external" href="https://f5.com/resources/white-papers/fundamentals-of-http">https://f5.com/resources/white-papers/fundamentals-of-http</a></p>
<p><a class="reference external" href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html">http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html</a></p>
<p><strong>HTTP Methods</strong></p>
<p>When you open up a browser and request a web page (either by setting a
default page or by entering a Uniform Resource Locater or URL), the
first thing that happens is that the browser relies upon the operating
system to resolve the host name in the URL to an IP address. Normally
this is done via a DNS (Domain Name System) query over UDP (User
Datagram Protocol) on port 53. However, if the host is listed in the
local hosts file, the operating system will not make a DNS query.</p>
<p>When the IP address is obtained, the browser will attempt to open a TCP
(Transmission Control Protocol) connection to the web server, usually on
port 80. Once the TCP connection is made, the browser will issue an HTTP
request to the server using the connection. The request comprises a
header section, and possibly a body section (this is where things like
POST data go). Once the request is sent, the browser will wait for the
response. When the web server has assembled the response, it is sent
back to the browser for rendering.</p>
<p>The base request comprises a method, the URI (Uniform Resource
Indicator) of the web page or resource being requested, and the HTTP
version desired (1.0 or 1.1). The method may be one of:</p>
<ul class="simple">
<li>Get</li>
<li>Post</li>
<li>Put</li>
<li>Delete</li>
<li>Head</li>
</ul>
<p>Web servers almost universally support GET and POST, with the difference
between them being the way in which query parameters are represented.
With the GET method, all query parameters are part of the URI. This
restricts the length of the parameters because a URI is generally
limited to a set number of characters. Conversely, all parameters are
included within the body of the request when using the POST method and
there is usually no limit on the length of the body. PUT and DELETE,
though considered important for emerging technology architectures such
as REST (Representational State Transfer), are considered potentially
dangerous as they enable the user to modify resources on the web server.
These methods are generally disabled on web servers and not supported by
modern web browsers.</p>
<p>The HTTP response consists of a header section and a body. The header
section tells the browser how to treat the body content and the browser
renders the content for viewing. Each HTTP response includes a status
code, which indicates the status of the request. The most common status
codes are:</p>
<p>200 OK. This indicates success</p>
<p>304 Not Modified. This shows that the resource in question has not
changed and the browser should load it from its cache instead. This is
only used when the browser performs a conditional GET request.</p>
<p>404 Not Found. This suggests that the resource requested cannot be found
on the server.</p>
<p>401 Authorization Required. This indicates that the resource is
protected and requires valid credentials before the server can grant
access.</p>
<p>500 Internal Error. This signifies that the server had a problem
processing the request.</p>
<p>While most developers do not need to know these status codes as they are
not used within D/HTML, AJAX (Asynchronous Javascript and XML)
developers may need to recognize these codes as part of their
development efforts.</p>
<p>Most HTTP responses will also contain references to other objects within
the body that will cause the browser to automatically request these
objects as well. Web pages often contain more than 30 other object
references required to complete the page.</p>
<p>When retrieving these referenced objects, the default browser behavior
is to open two TCP connections per host seen in the references. With
Internet Explorer there is a Windows registry setting that limits this
to a total of eight TCP connections. There is a similar setting in
Firefox, but its maximum is 24 TCP connections.</p>
<p>Get</p>
<p>The GET method means retrieve whatever information (in the form of an
entity) is identified by the Request-URI. If the Request-URI refers to a
data-producing process, it is the produced data, which shall be returned
as the entity in the response and not the source text of the process,
unless that text happens to be the output of the process.</p>
<p>The semantics of the GET method change to a “conditional GET” if the
request message includes an If-Modified-Since, If-Unmodified-Since,
If-Match, If-None-Match, or If-Range header field. A conditional GET
method requests that the entity be transferred only under the
circumstances described by the conditional header field(s). The
conditional GET method is intended to reduce unnecessary network usage
by allowing cached entities to be refreshed without requiring multiple
requests or transferring data already held by the client.</p>
<p>The semantics of the GET method change to a “partial GET” if the request
message includes a Range header field. A partial GET requests that only
part of the entity be transferred. The partial GET method is intended to
reduce unnecessary network usage by allowing partially retrieved
entities to be completed without transferring data already held by the
client.</p>
<p>The response to a GET request is cacheable if and only if it meets the
requirements for HTTP caching.</p>
<p><strong>PUT</strong></p>
<p>The PUT method requests that the enclosed entity be stored under the
supplied Request-URI. If the Request-URI refers to an already existing
resource, the enclosed entity SHOULD be considered as a modified version
of the one residing on the origin server. If the Request-URI does not
point to an existing resource, and that URI is capable of being defined
as a new resource by the requesting user agent, the origin server can
create the resource with that URI. If a new resource is created, the
origin server MUST inform the user agent via the 201 (Created) response.
If an existing resource is modified, either the 200 (OK) or 204 (No
Content) response codes SHOULD be sent to indicate successful completion
of the request. If the resource could not be created or modified with
the Request-URI, an appropriate error response SHOULD be given that
reflects the nature of the problem. The recipient of the entity MUST NOT
ignore any Content-* (e.g. Content-Range) headers that it does not
understand or implement and MUST return a 501 (Not Implemented) response
in such cases.</p>
<p>If the request passes through a cache and the Request-URI identifies one
or more currently cached entities, those entries SHOULD be treated as
stale. Responses to this method are not cacheable.</p>
<p>The fundamental difference between the POST and PUT requests is
reflected in the different meaning of the Request-URI. The URI in a POST
request identifies the resource that will handle the enclosed entity.
That resource might be a data-accepting process, a gateway to some other
protocol, or a separate entity that accepts annotations. In contrast,
the URI in a PUT request identifies the entity enclosed with the request
the user agent knows what URI is intended and the server MUST NOT
attempt to apply the request to some other resource. If the server
desires that the request be applied to a different URI, it MUST send a
301 (Moved Permanently) response; the user agent MAY then
make its own decision regarding whether or not to redirect the request.</p>
<p>Many different URIs MAY identify a single resource. For example, an
article might have a URI for identifying “the current version” which is
separate from the URI identifying each particular version. In this case,
a PUT request on a general URI might result in several other URIs being
defined by the origin server.</p>
<p>HTTP/1.1 does not define how a PUT method affects the state of an origin
server.</p>
<p>Unless otherwise specified for a particular entity-header, the
entity-headers in the PUT request SHOULD be applied to the resource
created or modified by the PUT.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.06 - Explain how to decode POST data</strong></p>
<p>You can decode post data within an iRule if you are trying to manipulate
or rewrite a URL data.</p>
<hr class="docutils" />
<p><a class="reference external" href="https://devcentral.f5.com/codeshare?sid=523">https://devcentral.f5.com/codeshare?sid=523</a></p>
<p>And there are plenty of online encoding and decoding tools you can use
if you are just trying to see what is being passed in your browser. The
following site is one example of an online tool.</p>
<hr class="docutils" />
<p><a class="reference external" href="https://www.url-encode-decode.com/">https://www.url-encode-decode.com/</a></p>
<p>URL encoding stands for encoding certain characters in a URL by
replacing them with one or more character-triplets that consist of the
percent character “%” followed by two hexadecimal digits. The two
hexadecimal digits of the triplet(s) represent the numeric value of the
replaced character.</p>
<p>The term URL encoding is a bit inexact because the encoding procedure is
not limited to URLs (Uniform Resource Locators) but can also be applied
to any other URIs (Uniform Resource Identifiers) such as URNs (Uniform
Resource Names). Therefore, the term percent-encoding should be
preferred.</p>
<p>For worldwide interoperability, URIs have to be encoded uniformly. To
map the wide range of characters used worldwide into the 60 or so
allowed characters in a URI, a two-step process is used:</p>
<ul class="simple">
<li>Convert the character string into a sequence of bytes using the UTF-8
encoding</li>
<li>Convert each byte that is not an ASCII letter or digit to %HH, where
HH is the hexadecimal value of the byte</li>
</ul>
<p>For example, the string: François ,would be encoded as: Fran%C3%A7ois</p>
<p>(The “ç” is encoded in UTF-8 as two bytes C3 (hex) and A7 (hex), which
are then written as the three characters “%c3” and “%a7” respectively.)
This can make a URI rather long (up to 9 ASCII characters for a single
Unicode character), but the intention is that browsers only need to
display the decoded form, and many protocols can send UTF-8 without the
%HH escaping.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-07-given-a-set-of-headers-or-traces-determine-a-solution-to-an-http-https-application-problem">
<h2>Objective - 2.07 Given a set of headers or traces, determine a solution to an HTTP/HTTPS application problem<a class="headerlink" href="#objective-2-07-given-a-set-of-headers-or-traces-determine-a-solution-to-an-http-https-application-problem" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.07 - Investigate the cause of a specific response code</strong></p>
<p><a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-troubleshoot-common-http-error-codes">https://www.digitalocean.com/community/tutorials/how-to-troubleshoot-common-http-error-codes</a></p>
<p><strong>Determine cause of a specific response code</strong></p>
<p>There are many possible response codes as we covered in section 2.06.</p>
<p>404 Not Found</p>
<p>The 404 status code, or a Not Found error, means that the user is able
to communicate with the server but it is unable to locate the requested
file or resource.</p>
<p>404 errors can occur in a large variety of situations. If the user is
unexpectedly receiving a 404 Not Found error, here are some questions to
ask while troubleshooting:</p>
<ul class="simple">
<li>Does the link that directed the user to your server resource have a
typographical error in it?</li>
<li>Did the user type in the wrong URL?</li>
<li>Does the file exist in the correct location on the server? Was the
resource was moved or deleted on the server?</li>
<li>Does the server configuration have the correct document root
location?</li>
<li>Does the user that owns the web server worker process have privileges
to traverse to the directory that the requested file is in? (Hint:
directories require read and execute permissions to be accessed)</li>
<li>Is the resource being accessed a symbolic link? If so, ensure the web
server is configured to follow symbolic links.</li>
</ul>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.07 - Investigate the cause of an SSLHandshake failure</strong></p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K15292">https://support.f5.com/csp/article/K15292</a></p>
<p><strong>Troubleshooting SSLHandshake failures</strong></p>
<p>SSL handshake overview</p>
<p>SSL communication consists of a series of messages exchanged between two
parties (client and server). The SSL handshake between a client and
server consists of nine steps, and appears as follows.</p>
<img alt="../../_images/p102.png" src="../../_images/p102.png" />
<p>Identifying SSL handshake failures</p>
<p>When troubleshooting SSL handshake failures, it is important to identify
the stage in which the failure occurs. For example, if the failure
occurs during the initial negotiation phase, the client and server may
not have agreed on the complete list of parameters, such as protocol
version or cipher. For information about identifying handshake failures,
refer to the following sections.</p>
<p>Negotiation stage</p>
<p>During the negotiation phase, the client starts the SSL communication
between the two systems by presenting the SSL options to the server, and
the server responds by selecting the options it supports. This stage
defines the parameters for the secure channel. If the client and server
do not agree on the complete list of options, the handshake will fail,
often with very little diagnostic data. The most common failures during
the negotiation stage involve the following incompatible components:
protocols, ciphers, secure renegotiation options, or client certificate
requests.</p>
<p>To understand failures in the negotiation stage, it is important to
understand the client and server behavior during the message exchange.</p>
<ul class="simple">
<li>The ClientHello offers the highest protocol version supported by the
client. If the server does not support the client’s protocol version,
the server must send a “protocol_version” alert message and close
the connection. If the server responds with a lower protocol version,
the client then decides whether to downgrade the protocol or
terminate the SSL handshake.</li>
<li>The ClientHello also offers a list of supported cipher suites, in the
preferred order. The server then typically chooses the highest cipher
level shared by both. If the server does not support the ciphers from
the client’s list, the connection is terminated.</li>
</ul>
<p>Negotiation phase handshake examples</p>
<ul>
<li><p class="first">Successful negotiation</p>
<p>In the following example, the client offered protocol TLSv1.2
(version 3.3) and the server downgraded the protocol to TLSv1.0
(version 3.1). The server also chose the preferred cipher from the
client’s list:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">1</span> <span class="m">0</span>.0003 <span class="o">(</span><span class="m">0</span>.0003<span class="o">)</span> C&gt;SV3.3<span class="o">(</span><span class="m">79</span><span class="o">)</span> Handshake
ClientHello
Version <span class="m">3</span>.3
cipher suites
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>RC4<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>SHA
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">256</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA256
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">256</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA256
<span class="m">1</span> <span class="m">2</span> <span class="m">0</span>.0008 <span class="o">(</span><span class="m">0</span>.0005<span class="o">)</span> S&gt;CV3.1<span class="o">(</span><span class="m">74</span><span class="o">)</span> Handshake
ServerHello
Version <span class="m">3</span>.1
cipherSuite TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>RC4<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>SHA
</pre></div>
</div>
</li>
<li><p class="first">Unsuccessful negotiation</p>
</li>
</ul>
<p>In the following examples, the client and server fail to agree on the
SSL protocol version in the first example, and the SSL cipher in the
second example.</p>
<p>Example 1: The client and server unsuccessfully negotiate the protocol.
The server does not support protocol version below TLS1 (version 3.1)
and the client does not support protocol versions above SSLv3 (version
3.0):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">1</span> <span class="m">0</span>.0012 <span class="o">(</span><span class="m">0</span>.0012<span class="o">)</span> C&gt;SV3.0<span class="o">(</span><span class="m">47</span><span class="o">)</span> Handshake
ClientHello
Version <span class="m">3</span>.0
cipher suites
SSL<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">256</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA
<span class="m">1</span> <span class="m">2</span> <span class="m">0</span>.0013 <span class="o">(</span><span class="m">0</span>.0000<span class="o">)</span> S&gt;CV0.0<span class="o">(</span><span class="m">2</span><span class="o">)</span> Alert
level fatal
value handshake<span class="se">\_</span>failure
</pre></div>
</div>
<p>Example 2: The client and server unsuccessfully negotiate a cipher; the
server does not support any of the client’s ciphers. This is a common
failure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">1</span> <span class="m">0</span>.0012 <span class="o">(</span><span class="m">0</span>.0012<span class="o">)</span> C&gt;SV3.1<span class="o">(</span><span class="m">58</span><span class="o">)</span> Handshake
ClientHello
Version <span class="m">3</span>.2
cipher suites
TLS<span class="se">\_</span>DH<span class="se">\_</span>anon<span class="se">\_</span>WITH<span class="se">\_</span>RC4<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>MD5
<span class="m">1</span> <span class="m">2</span> <span class="m">0</span>.0013 <span class="o">(</span><span class="m">0</span>.0000<span class="o">)</span> S&gt;CV3.2<span class="o">(</span><span class="m">2</span><span class="o">)</span> Alert
level fatal
value handshake<span class="se">\_</span>failure
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The SSL alert message (Alert 2 level fatal) is marginally
useful and means an unrecoverable error has occurred. If the virtual
server is using a Client SSL profile, you may be able to enable
useful message logging by modifying the SSL logging level to debug.</p>
</div>
<p>ChangeCipherSpec (client)</p>
<p>During the client’s ChangeCipherSpec phase, the client initializes the
options that were negotiated by both parties. This phase marks the point
when the parties change the secure channel parameters from using
asymmetric (public key) to symmetric (shared key) encryption. A
handshake failure during this phase may relate to SSL message corruption
or issues with the SSL implementation itself.</p>
<p>ChangeCipherSpec (server)</p>
<p>During the server’s ChangeCipherSpec phase, the server initializes the
options that were negotiated by both parties. This phase marks the point
when the parties change the secure channel parameters from using
asymmetric (public key) to symmetric (shared key) encryption. A
handshake failure during this phase may relate to SSL message corruption
or issues with the SSL implementation itself.</p>
<p>Application phase</p>
<p>Messages marked as application_data indicate that data is being
successfully encrypted. Failures in the application phase indicate
application layer events. For example, a client’s request for a document
that results in an HTTP 500 error, may cause a failure during this
phase. To diagnose failures during the application phase, you must
decrypt the SSL session using a utility, such as ssldump.</p>
<p>Enabling SSL debug logging</p>
<p>You can enable SSL debug logging on the BIG-IP system, test SSL
connections for the virtual server using a web browser or the OpenSSL
client, and then review the debug log files. Doing so will provide more
useful logging information when troubleshooting SSL handshake failures.</p>
<p>Note: Beginning in 12.0.0, the BIG-IP system automatically logs SSL
handshake failure information through standard logging; the use of debug
logging for SSL handshake failures is not required.</p>
<p>For example, with debug logging enabled, the system logs error messages
similar to the /var/log/ltm file that appear similar to the following:</p>
<ul>
<li><p class="first">The client and server unsuccessfully negotiate the protocol version:</p>
<p>debug tmm3[9261]: 01260009:7: Connection error:
ssl_hs_rxhello:4409: unsupported version (70)</p>
</li>
<li><p class="first">The client and server unsuccessfully negotiate a cipher:</p>
<p>debug tmm1[9261]: 01260009:7: Connection error:
ssl_select_suite:4133: no shared ciphers (40)</p>
</li>
</ul>
<p>To enable SSL debug logging, perform the following procedure:</p>
<p>Impact of procedure: F5 recommends that you return the SSL log level to
the default value after you complete the troubleshooting steps. Leaving
debug logging enabled when the system is in normal production mode may
generate excessive logging and cause poor performance.</p>
<ol class="arabic">
<li><p class="first">Log in to the TMOS Shell (tmsh) by typing the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tmsh
</pre></div>
</div>
</li>
<li><p class="first">To enable SSL debug logging, type the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>modify /sys db log.ssl.level value Debug
</pre></div>
</div>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p>After you test SSL connections for the virtual server using a
web browser or OpenSSL client, you should disable SSL debug logging by
typing the following command:</p>
<div class="last highlight-bash notranslate"><div class="highlight"><pre><span></span>modify /sys db log.ssl.level value Warning
</pre></div>
</div>
</div>
</li>
</ol>
<p>Testing SSL connections (using s_client)</p>
<p>After you enable SSL debug logging on the BIG-IP system, you should test
SSL connections for the virtual server using a web browser or other
utility, such as the OpenSSL utility, s_client, or cURL. Using the
s_client utility may provide additional debugging information that you
can use to troubleshoot the issue. After making several requests to the
virtual server, you can review and analyze the debug log files on the
BIG-IP system.</p>
<p>Impact of procedure: Performing the following procedure should not have
a negative impact on your system.</p>
<ol class="arabic">
<li><p class="first">Log in to the command line of a Linux host (with a current version of
OpenSSL) that can access the SSL virtual server.</p>
</li>
<li><p class="first">To test SSL connections for the virtual server, use the following
command syntax:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>  openssl s<span class="se">\_</span>client -connect &lt;virtual<span class="se">\_</span>server&gt;:&lt;port&gt;

For example:

.. code-block:: bash

   openssl s<span class="se">\_</span>client -connect <span class="m">10</span>.12.23.115:443
</pre></div>
</div>
</li>
<li><p class="first">If the handshake attempt fails, take note of SSL errors returned by
the s_client utility.</p>
</li>
<li><p class="first">If the handshake succeeds, type the following at the prompt:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>GET / HTTP/1.0
</pre></div>
</div>
</li>
<li><p class="first">Press Enter twice.</p>
<p>The HTML page should display.</p>
</li>
</ol>
<p>Reviewing log messages related to SSL handshake failures</p>
<p>After you test SSL connections using a web browser or OpenSSL client,
you should review the BIG-IP log files for debug error messages related
to the SSL handshake. To do so, perform the following procedure:</p>
<p>Impact of procedure: Performing the following procedure should not have
a negative impact on your system.</p>
<ol class="arabic">
<li><p class="first">Log in to the BIG-IP command line.</p>
</li>
<li><p class="first">Use a Linux text utility to review the /var/log/ltm file. For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tail -f /var/log/ltm
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>To filter the log information for SSL errors only, use the
grep command. For example:</p>
<div class="last highlight-bash notranslate"><div class="highlight"><pre><span></span>cat /var/log/ltm <span class="se">\|</span>grep -i <span class="s1">&#39;ssl&#39;</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Review the debug logs for SSL handshake failure or SSL alert codes.</p>
</li>
</ol>
<p>Additionally, you can use the grep or egrep commands to filter for
specific SSL-related keywords in the log files. To do so, refer to the
following commands:</p>
<p>To display log messages related to cipher or profile, use the grep or
egrep commands to search for certain patterns in the /var/log/ltm file.</p>
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>egrep -i <span class="s1">&#39;cipher \| profile&#39;</span> /var/log/ltm
</pre></div>
</div>
<p>You may observe messages similar to the following examples.</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>SSL message</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>01260014:3: Cipher &lt;cipher&gt; negotiated is not configured in profile &lt;profile_name&gt;</td>
<td>The cipher negotiated by the client and server is not supported in one of the SSL profiles</td>
</tr>
<tr class="row-odd"><td>01260026:4: No shared ciphers between SSL peers &lt;client_IP&gt;:&lt;server_IP&gt;</td>
<td>None of the SSL ciphers sent by the client match the configured ciphers in the Client SSL profile. This error can occur when an older SSL client using a less secure cipher attempts to connect to the virtual server</td>
</tr>
</tbody>
</table>
<p>To display log messages related to ssl and tps, use the grep or egrep
commands to search for certain patterns in the /var/log/ltm file.</p>
<p>For example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>egrep -i <span class="s1">&#39;ssl.\*tps&#39;</span> /var/log/ltm
</pre></div>
</div>
<p>You may observe messages similar to the following example.</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head"><strong>SSL message</strong></th>
<th class="head"><strong>Description</strong></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>err tmm&lt;instance&gt;[&lt;pid&gt;]: 01260008:3: SSL transaction (TPS) rate limit reached</td>
<td>The BIG-IP system is handling a large number of Secure Socket Layer (SSL) connections and the number of SSL TPS connections reaches or exceeds the licensed limit.</td>
</tr>
</tbody>
</table>
<p>Packet tracing using the ssldump utility</p>
<p>The ssldump utility is a protocol analyzer for SSL that identifies TCP
connections from a chosen packet trace or network interface and attempts
to interpret the packets as SSL traffic. When the ssldump utility
identifies SSL traffic, it decodes the records and displays them in text
to standard output. If provided with the private key that was used to
encrypt the connections, the ssldump utility may also be able to decrypt
the connections and display the application data traffic. You can use
the ssldump utility to examine, decrypt, and decode SSL-encrypted packet
streams that are processed by the BIG-IP system. For information about
using ssldump to troubleshoot SSL handshake failures, refer to K10209:
Overview of packet tracing with the ssldump utility.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.07 - Predict the browser caching behavior when application data is received (headers and HTML)</strong></p>
<p><a class="reference external" href="https://www.f5.com/services/resources/white-papers/caching-behavior-of-web-browsers">https://www.f5.com/services/resources/white-papers/caching-behavior-of-web-browsers</a></p>
<p><strong>Browser Caching Behavior</strong></p>
<p>When a user visits a web page, the contents of that page can be stored
in the browser’s cache so it doesn’t need to be re-requested and
re-downloaded. Efficiently using the browser cache can improve end user
response times and reduce bandwidth utilization.</p>
<p>The cache-ability of an item on the browser is determined by:</p>
<ul class="simple">
<li>The response headers returned from the origin web server. If the
headers indicate that content should not be cached then it won’t be.</li>
<li>A validator such as an ETag or Last-Modified header must be present
in the response.</li>
</ul>
<p>If an item is considered cacheable, the browser will retrieve the item
from cache on repeat visits if it is considered “fresh.” Freshness is
determined by:</p>
<ul class="simple">
<li>A valid expiration time that is still within the fresh period.</li>
<li>The browser settings as explained below.</li>
</ul>
<p>If a representation is stale or does not have a valid expiration date,
the browser will ask the web server of origin to validate the content to
confirm that the copy it has can be served. The web server will then
return a 304 to let the browser know that the local cached copy is still
good to use. If the content has changed, the web server returns a 200
response code and delivers the new version.</p>
<p>How the browser cache is used is dependent on three main things:</p>
<ul class="simple">
<li>Browser settings</li>
<li>The web site (HTML code and HTTP headers)</li>
<li>How the user loads the page</li>
</ul>
<p>In most instances the cache behavior of content is controlled by the
Cache-Control and Expires HTTP headers. Cache-Control headers specify
whether or not the content can be cached and for how long. The values
can include:</p>
<ul class="simple">
<li>no-cache – Do not cache this content</li>
<li>private – Can be cached by browsers, but not shared/public caches</li>
<li>max-age – Set in seconds; specifies the maximum amount of time
content is considered fresh</li>
</ul>
<p>The inclusion of just an Expires header with no Cache-Control header
indicates that the content can be cached by both browsers and
public/shared caches and is considered stale after the specified date
and time as shown below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>Status-Line<span class="o">)</span> HTTP/1.1 <span class="m">200</span> OK
Content-Length <span class="m">4722</span>
Content-Type image/gif
Date Fri, <span class="m">31</span> Aug <span class="m">2007</span> <span class="m">10</span>:20:29 GMT
Expires Sun, <span class="m">17</span> Jan <span class="m">2038</span> <span class="m">19</span>:14:07 GMT
Last-Modified Wed, <span class="m">07</span> Jun <span class="m">2006</span> <span class="m">23</span>:55:38 GMT
URL in cache? Yes
Expires <span class="m">19</span>:14:07 Sun, <span class="m">17</span> Jan <span class="m">2038</span> GMT
Last Modification <span class="m">23</span>:55:38 Wed, <span class="m">07</span> Jun <span class="m">2006</span> GMT
Last Cache Update <span class="m">10</span>:20:32 Friday, August <span class="m">31</span>, <span class="m">2007</span> GMT
Last Access <span class="m">10</span>:20:31 Friday, August <span class="m">31</span>, <span class="m">2007</span> GMT
ETag
Hit Count <span class="m">1</span>
</pre></div>
</div>
<p>If no Cache-Control or Expires headers are present, the browser will
cache the content with no expiration date as illustrated below:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Headers:
<span class="o">(</span>Status-Line<span class="o">)</span> HTTP/1.1 <span class="m">200</span> OK
Accept-Ranges bytes
Connection Keep-Alive
Content-Length <span class="m">221</span>
Content-Type Image/gif
Date Fri, <span class="m">31</span> Aug <span class="m">2007</span> <span class="m">10</span>:27:06 GMT
Last-Modified Fri, <span class="m">02</span> Jun <span class="m">2006</span> <span class="m">09</span>:46:32 GMT
URL in cache? Yes
Expires <span class="o">(</span>Not <span class="nb">set</span><span class="o">)</span>
Last Modification <span class="m">09</span>:46:32 Friday, June <span class="m">02</span>, <span class="m">2006</span> GMT
Last Cache Update <span class="m">10</span>:26:32 Friday, August <span class="m">31</span>, <span class="m">2007</span> GMT
Last Access <span class="m">10</span>:26:31 Friday, August <span class="m">31</span>, <span class="m">2007</span> GMT
ETag
Hit Count <span class="m">1</span>
</pre></div>
</div>
<p>Some web developers have opted to use META Tags to control how content
can be cached as opposed to setting cache parameters in the HTTP
headers. Using the HTTP header is the preferred and recommended way of
controlling the cache behavior.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-08-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-the-root-cause-of-an-http-https-application-problem">
<h2>Objective - 2.08 Given a direct trace, a trace through the LTM device, and other relevant information, compare the traces to determine the root cause of an HTTP/HTTPS application problem<a class="headerlink" href="#objective-2-08-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-the-root-cause-of-an-http-https-application-problem" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.08 - Given a failed HTTP request and LTM configuration data determine if the connection is failing due to the LTM configuration</strong></p>
<p><strong>Configuration Problem Determination</strong></p>
<p>This Objective and Example are very broad. They have to be to cover all
of the possible issues you can run into. A detailed understanding of why
the application is failing will allow you to correct the issue. I will
focus on SNAT issues for this example. There can be many other reasons
an application is failing.</p>
<p>When you are troubleshooting scenarios and looking at packet traces you
may need to recognize if SNAT needs to be enabled or disabled in the
BIG-IP flow. When SNAT is not enabled the client IP address will remain
the same on both sides of the flow. When SNAT is enabled the client ip
address will be changed to an IP address controlled by the BIG-IP.</p>
<hr class="docutils" />
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-1/17.html">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-1/17.html</a></p>
<p>In the most common client-server network configuration, the Local
Traffic Manager™ standard address translation mechanism ensures that
server responses return to the client through the BIG-IP® system,
thereby reversing the original destination IP address translation. This
typical network configuration is as follows:</p>
<p>The server nodes are on the same subnet as the BIG-IP system.</p>
<p>The client nodes are on a different subnet from the server nodes.</p>
<p>The BIG-IP system is the default gateway for the server subnet.</p>
<p>However, there are atypical network configurations in which the standard
BIG-IP system address translation sequence by itself does not ensure
that server responses use the required return path. Examples of these
atypical configurations are:</p>
<p>When clients and servers are on the same network</p>
<p>If you want to load balance requests to server nodes that are on the
same network as the client nodes, you can create a SNAT so that server
responses are sent back through the virtual server, rather than directly
from the server node to the client node. Otherwise, problems can occur
such as the client rejecting the response because the source of the
response does not match the destination of the request. Known as virtual
server bounceback, this SNAT configuration causes the source of the
response to match the destination of the request, thus ensuring that the
client node accepts the response. You can use this kind of configuration
when you want to load balance requests from web servers to application
servers on the same network.</p>
<p>When the default gateway of the server node is not the BIG-IP system</p>
<p>For various reasons, the server node’s default route cannot always be
defined to be a route back through the BIG-IP system. Again, this can
cause problems such as the client rejecting the response because the
source of the response does not match the destination of the request.
The solution is to create a SNAT. When Local Traffic Manager then
translates the client node’s source IP address in the request to the
SNAT address, this causes the server node to use that SNAT address as
its destination address when sending the response. This, in turn, forces
the response to return to the client node through the BIG-IP system
rather than through the server node’s default gateway.</p>
<p>When using the OneConnect feature</p>
<p>Local Traffic Manager OneConnect™ feature allows client requests to
re-use idle server-side connections. Without a SNAT, the source IP
address in the server-side connection remains the address of the client
node that initially established the connection, regardless of which
other client nodes re-use the connection. Although this is not an issue
for traffic routing, you might find it confusing when examining various
types of system output. A SNAT solves this problem.</p>
<p>Note: Using a SNAT for inbound connections can impact the availability
of ephemeral ports. This can lead to the SNAT being unable to process
additional connections until some source ports become available.</p>
<p>This image shows a typical problem for client-initiated connections when
Local Traffic Manager is not defined as the server’s default gateway,
and you have not configured a SNAT for inbound traffic.</p>
<img alt="../../_images/p112.png" src="../../_images/p112.png" />
<p>Client rejects response due to non-matching destination and source IP
addresses</p>
<p>To prevent these problems, you can configure an inbound SNAT. An inbound
SNAT translates the original client source IP address in a request to a
BIG-IP system virtual server or BIG-IP system self IP address, forcing
subsequent server response to return directly to Local Traffic Manager.
When an inbound SNAT is configured on the system, Local Traffic Manager
translates not only the destination IP address in the request (using the
standard address translation mechanism), but also the source IP address
in the request (using a SNAT).</p>
<p>The figure below shows that by configuring a SNAT, you ensure that the
response returns through the BIG-IP system instead of through the
default gateway, thus ensuring that the client can accept the server
response.</p>
<img alt="../../_images/p122.png" src="../../_images/p122.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-09-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-a-solution-to-an-http-https-application-problem">
<h2>Objective - 2.09 Given a direct trace, a trace through the LTM device, and other relevant information, compare the traces to determine a solution to an HTTP/HTTPS application problem<a class="headerlink" href="#objective-2-09-given-a-direct-trace-a-trace-through-the-ltm-device-and-other-relevant-information-compare-the-traces-to-determine-a-solution-to-an-http-https-application-problem" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.09 - Investigate the cause of an SSL Handshake failure</strong></p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K15292#id">https://support.f5.com/csp/article/K15292#id</a></p>
<p>Identifying SSL handshake failures</p>
<p>When troubleshooting SSL handshake failures, it is important to identify
the stage in which the failure occurs. For example, if the failure
occurs during the initial negotiation phase, the client and server may
not have agreed on the complete list of parameters, such as protocol
version or cipher. For information about identifying handshake failures,
refer to the following sections.</p>
<p>Negotiation stage</p>
<p>During the negotiation phase, the client starts the SSL communication
between the two systems by presenting the SSL options to the server, and
the server responds by selecting the options it supports. This stage
defines the parameters for the secure channel. If the client and server
do not agree on the complete list of options, the handshake will fail,
often with very little diagnostic data. The most common failures during
the negotiation stage involve the following incompatible components:
protocols, ciphers, secure renegotiation options, or client certificate
requests.</p>
<p>To understand failures in the negotiation stage, it is important to
understand the client and server behavior during the message exchange.</p>
<p>The ClientHello offers the highest protocol version supported by the
client. If the server does not support the client’s protocol version,
the server must send a “protocol_version” alert message and close the
connection. If the server responds with a lower protocol version, the
client then decides whether to downgrade the protocol or terminate the
SSL handshake.</p>
<p>The ClientHello also offers a list of supported cipher suites, in the
preferred order. The server then typically chooses the highest cipher
level shared by both. If the server does not support the ciphers from
the client’s list, the connection is terminated.</p>
<p>Negotiation phase handshake examples</p>
<p>Successful negotiation</p>
<p>In the following example, the client offered protocol TLSv1.2 (version
3.3) and the server downgraded the protocol to TLSv1.0 (version 3.1).
The server also chose the preferred cipher from the client’s list:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">1</span> <span class="m">0</span>.0003 <span class="o">(</span><span class="m">0</span>.0003<span class="o">)</span> C&gt;SV3.3<span class="o">(</span><span class="m">79</span><span class="o">)</span> Handshake
ClientHello
Version <span class="m">3</span>.3
cipher suites
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>RC4<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>SHA
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">256</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA256
TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">256</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA256
<span class="m">1</span> <span class="m">2</span> <span class="m">0</span>.0008 <span class="o">(</span><span class="m">0</span>.0005<span class="o">)</span> S&gt;CV3.1<span class="o">(</span><span class="m">74</span><span class="o">)</span> Handshake
ServerHello
Version <span class="m">3</span>.1
cipherSuite TLS<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>RC4<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>SHA
Unsuccessful negotiation
</pre></div>
</div>
<p>In the following examples, the client and server fail to agree on the
SSL protocol version in the first example, and the SSL cipher in the
second example.</p>
<p>Example 1: The client and server unsuccessfully negotiate the protocol.
The server does not support protocol version below TLS1 (version 3.1)
and the client does not support protocol versions above SSLv3 (version
3.0):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">1</span> <span class="m">0</span>.0012 <span class="o">(</span><span class="m">0</span>.0012<span class="o">)</span> C&gt;SV3.0<span class="o">(</span><span class="m">47</span><span class="o">)</span> Handshake
ClientHello
Version <span class="m">3</span>.0
cipher suites
SSL<span class="se">\_</span>RSA<span class="se">\_</span>WITH<span class="se">\_</span>AES<span class="se">\_</span><span class="m">256</span><span class="se">\_</span>CBC<span class="se">\_</span>SHA
<span class="m">1</span> <span class="m">2</span> <span class="m">0</span>.0013 <span class="o">(</span><span class="m">0</span>.0000<span class="o">)</span> S&gt;CV0.0<span class="o">(</span><span class="m">2</span><span class="o">)</span> Alert
level fatal
value handshake<span class="se">\_</span>failure
</pre></div>
</div>
<p>Example 2: The client and server unsuccessfully negotiate a cipher; the
server does not support any of the client’s ciphers. This is a common
failure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">1</span> <span class="m">1</span> <span class="m">0</span>.0012 <span class="o">(</span><span class="m">0</span>.0012<span class="o">)</span> C&gt;SV3.1<span class="o">(</span><span class="m">58</span><span class="o">)</span> Handshake
ClientHello
Version <span class="m">3</span>.2
cipher suites
TLS<span class="se">\_</span>DH<span class="se">\_</span>anon<span class="se">\_</span>WITH<span class="se">\_</span>RC4<span class="se">\_</span><span class="m">128</span><span class="se">\_</span>MD5
<span class="m">1</span> <span class="m">2</span> <span class="m">0</span>.0013 <span class="o">(</span><span class="m">0</span>.0000<span class="o">)</span> S&gt;CV3.2<span class="o">(</span><span class="m">2</span><span class="o">)</span> Alert
level fatal
value handshake<span class="se">\_</span>failure
</pre></div>
</div>
<p>Note: The SSL alert message (Alert 2 level fatal) is marginally useful
and means an unrecoverable error has occurred. If the virtual server is
using a Client SSL profile, you may be able to enable useful message
logging by modifying the SSL logging level to debug.</p>
<p>ChangeCipherSpec (client)</p>
<p>During the client’s ChangeCipherSpec phase, the client initializes the
options that were negotiated by both parties. This phase marks the point
when the parties change the secure channel parameters from using
asymmetric (public key) to symmetric (shared key) encryption. A
handshake failure during this phase may relate to SSL message corruption
or issues with the SSL implementation itself.</p>
<p>ChangeCipherSpec (server)</p>
<p>During the server’s ChangeCipherSpec phase, the server initializes the
options that were negotiated by both parties. This phase marks the point
when the parties change the secure channel parameters from using
asymmetric (public key) to symmetric (shared key) encryption. A
handshake failure during this phase may relate to SSL message corruption
or issues with the SSL implementation itself.</p>
<p>Application phase</p>
<p>Messages marked as application_data indicate that data is being
successfully encrypted. Failures in the application phase indicate
application layer events. For example, a client’s request for a document
that results in an HTTP 500 error, may cause a failure during this
phase. To diagnose failures during the application phase, you must
decrypt the SSL session using a utility, such as ssldump.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.09 - Given a failed HTTP request and LTM configuration data determine if the connection is failing due to the LTM configuration</strong></p>
<p><strong>Configuration Problem Determination</strong></p>
<p>This Objective and Example are very broad. They have to be to cover all
of the possible issues you can run into. A detailed understanding of why
the application is failing will allow you to correct the issue. I will
focus on SSL termination for this example. There can be many other
reasons an application is failing.</p>
<p>When you are troubleshooting scenarios and looking at packet traces you
may need to recognize if SSL termination (offloading) is correctly
applied to the application’s BIG-IP flow. When SSL termination is
enabled the virtual server will listen for encrypted traffic and then
decrypt the traffic as it sends it to the destination server. This means
the servers are configured to listen on http while the virtual server is
listening on https. Many times an administrator can make configuration
mistakes depending on the requirement to decrypt and re-encrypt.</p>
<hr class="docutils" />
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/bigip-ssl-administration-11-5-0/3.html#unique_1885783063">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/bigip-ssl-administration-11-5-0/3.html#unique_1885783063</a></p>
<p>About SSL offload</p>
<p>When you want the BIG-IP system to process application traffic over SSL,
you can configure the system to perform the SSL handshake that
destination servers normally perform. This ability for the BIG-IP system
to offload SSL processing from a destination server is an important
feature of the BIG-IP system.</p>
<p>The most common way to configure the BIG-IP system is to create a Client
SSL profile, which makes it possible for the BIG-IP system to decrypt
client requests before sending them on to a server, and encrypt server
responses before sending them back to the client.</p>
<p>Within a Client SSL profile specifically, you can specify multiple
certificate/key pairs, one per key type. This enables the system to
accept all types of cipher suites that a client might support as part of
creating a secure connection. The system then decrypts the client data,
manipulates any headers or payload according to the way that you
configured the Client SSL profile, and by default, sends the request in
clear text to the target server for processing.</p>
<p>For those sites that require enhanced security on their internal
network, you can configure a Server SSL profile. With a Server SSL
profile, the BIG-IP system re-encrypts the request before sending it to
the destination server. When the server returns an encrypted response,
the BIG-IP system decrypts and then re-encrypts the response, before
sending the response back to the client.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-10-given-a-scenario-determine-which-protocol-analyzer-tool-and-its-options-are-required-to-resolve-an-application-issue">
<h2>Objective - 2.10 Given a scenario, determine which protocol analyzer tool and its options are required to resolve an application issue<a class="headerlink" href="#objective-2-10-given-a-scenario-determine-which-protocol-analyzer-tool-and-its-options-are-required-to-resolve-an-application-issue" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.10 - Identify application issues based on a protocol analyzer trace</strong></p>
<p>To determine application issues, you will need to be familiar with how
to gather packet traces and what the output should look like when
applications are performing correctly. Since applications pass through
the BIG-IP, a mis-configuration of the BIG-IP can cause an application
fail. But if an app is broken, it will still be broken regardless of how
it is accessed. This can only be learned by doing captures of working
and broken application traffic.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.10 - Explain how to follow a conversation from client-side and server-side traces</strong></p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K411">https://support.f5.com/csp/article/K411</a></p>
<p><strong>Following a Conversation in a Capture</strong></p>
<p>When you have a proxy in the middle of a conversation flow as you do
when using a BIG-IP and you need to capture and see the complete
conversation, you will first need to successfully capture the data from
both sides of the proxy. This can be done in a few different ways.</p>
<p>You can do a separate capture on each side of the proxy by defining the
interface on which the traffic is received and egresses. Here we did it
based on VLAN names:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tcpdump -i external -s0 -w/var/tmp/extcap.cap

tcpdump -i internal -s0 -w/var/tmp/intcap.cap
</pre></div>
</div>
<p>This will give you two separate files to parse through side-by-side and
try to follow the conversation.</p>
<p>You can do a single capture of all traffic using the loopback interface:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tcpdump -i <span class="m">0</span>.0 -s0 -w/var/tmp/fullcap.cap
</pre></div>
</div>
<p>This will give you a single file to parse for both sides of the
conversation.</p>
<p>Gathering the data is the easy part. You can read the files in any way
you prefer but a tool like Wireshark makes the task much easier. You
need to look at each side of the conversation and find the corelating
flow. This can be done by right-clicking on a packet and filtering the
conversation. You can filter by IP or TCP. TCP conversation filter will
show you the flow of the TCP request.</p>
<img alt="../../_images/p131.png" src="../../_images/p131.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>You can find the start of a conversation by looking for the SYN that
starts a TCP 3-way handshake in each of the captures. On the external
side you can see the client IP (10.1.10.1) connect to the virtual server
listener (10.1.101.100).</p>
<img alt="../../_images/p142.png" src="../../_images/p142.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>On the internal side you can see the client IP (10.1.10.1) connect to
the physical server (10.1.20.11). The BIG-IP when load balancing will
translate destination IP from the Virtual Server IP address to the
physical server IP address as the packet passes, leaving the Client IP
the same.</p>
<img alt="../../_images/p152.png" src="../../_images/p152.png" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p>Other settings such as enabling SNAT on the BIG-IP can affect the Client
IP address on the internal side of the conversation.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.10 - Explain how SNAT and OneConnect effect protocol analyzer traces</strong></p>
<p><strong>SNAT and OneConnect</strong></p>
<p>SNAT and OneConnect can have a direct impact on your captures since they
both modify the typical connection flows in the system. SNAT does a
Source Network Address Translation thus if configured a source IP
addresses may change from one side of the full proxy to the other.
OneConnect is essentially TCP multiplexing and when enabled will attempt
to reuse existing established connections for the subsequent
connections. Both of these settings can cause you to get lost when
trying to follow connections from client to server and back again.</p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K13637">https://support.f5.com/csp/article/K13637</a></p>
<p>Beginning in BIG-IP 11.2.0, you can use the p interface modifier with
the n modifier to capture traffic with TMM information for a specific
flow and its related peer flow. The p modifier allows you to capture a
specific traffic flow through the BIG-IP system from end to end, even
when the configuration uses a secure network address translation (SNAT)
or OneConnect. For example, the following command searches for traffic
to or from client 10.0.0.1 on interface 0.0:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tcpdump -ni <span class="m">0</span>.0:nnnp -s0 -c <span class="m">100000</span> -w /var/tmp/capture.dmp host <span class="m">10</span>.0.0.1
</pre></div>
</div>
<p>After tcpdump identifies a related flow, the flow is marked in TMM, and
every subsequent packet in the flow (on both sides of the BIG-IP system)
is written to the capture file.</p>
<p>Important: This modifier produces large amounts of data and can cause
significant resource utilization. This additional resource demand may
cause poor performance or a system failure if the BIG-IP system is at
high resource utilization. Use this modifier only with very specific
filters.</p>
<p>Note: This modifier continues to produce flow information for the life
of the connection. Subsequent tcpdump captures reveal flow information
from previous tcpdump captures using the :p modifier if the connection
is still active. To clear flow information from previous use, run the
tcpdump command without the :p modifier using a filter that matches no
information in the flow and ensure some traffic has been received by the
BIG-IP system for the flow.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.10 - Explain how to decrypt SSL traffic for protocol analysis</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/10000/200/sol10209.html">https://support.f5.com/kb/en-us/solutions/public/10000/200/sol10209.html</a></p>
<p><strong>ssldump</strong></p>
<p>The Secure Socket Layer (SSL) protocol is used to encrypt sensitive data
for transmission on the Internet. If a BIG-IP LTM system is contributing
to a technical issue, it may be helpful to decrypt the application data
to better understand the issue. The ssldump utility is an SSL/TLS
network protocol analyzer, which identifies TCP connections from a
chosen packet trace or network interface and attempts to interpret them
as SSL/TLS traffic. When the ssldump utility identifies SSL/TLS traffic,
it decodes the records and displays them in text to standard output. If
provided with the private key that was used to encrypt the connections,
the ssldump utility may also be able to decrypt the connections and
display the application data traffic.</p>
<p>You can use the ssldump utility to examine, decrypt, and decode
SSL-encrypted packet streams managed by the BIG-IP system. The ssldump
utility can act on packet streams real-time as they traverse the system,
or on a packet capture file saved in the libpcap format, such as that
produced by the tcpdump utility. Although it is possible for the ssldump
utility to decode and display live traffic real-time as it traverses the
BIG-IP system, it is rarely the most effective method to examine the
voluminous and complex output of the ssldump utility. Capturing the
target traffic to a file using the tcpdump utility, then decoding the
file using the ssldump utility offers a better opportunity to examine
the traffic in detail.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.10 - Explain how to recognize the different causes of slow traffic (e.g., drops, RSTs, retransmits, ICMP errors, demotion from CMP)</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/9000/800/sol9812.html?sr=46608010">https://support.f5.com/kb/en-us/solutions/public/9000/800/sol9812.html?sr=46608010</a></p>
<p><strong>Causes of slow traffic</strong></p>
<p>There can be many different reasons for slow traffic or poor network
performance and to end users of a network-based application it all seems
the same “The network is slow”. Any of these topics or combination of
topics can cause the network to seem slow.</p>
<hr class="docutils" />
<p><strong>Resets</strong></p>
<p><a class="reference external" href="http://blogs.technet.com/b/networking/archive/2009/08/12/where-do-resets-come-from-no-the-stork-does-not-bring-them.aspx">http://blogs.technet.com/b/networking/archive/2009/08/12/where-do-resets-come-from-no-the-stork-does-not-bring-them.aspx</a></p>
<p>The BIG-IP system will close a TCP connection by sending a TCP RST
packet to a client and/or pool member under a variety of circumstances.
Depending on the specific BIG-IP configuration object, you can adjust
the BIG-IP system reset behavior from the default behavior by using the
Configuration utility or command line.</p>
<p>There are many reasons for resets, but some common causes of resets are
as follows:</p>
<p>Global settings:</p>
<ul>
<li><p class="first">Adaptive Reaping</p>
<p>To prevent SYN flood attacks, and to preserve memory, the BIG-IP
system can prevent new connections by sending a TCP RST packet to
the client when memory usage increases beyond the reaper high-water
mark setting. The TCP RST packet is sent on the client side of the
connection, and the source IP address of the reset is the relevant
BIG-IP LTM object IP address for which the SYN request was destined.</p>
<p>Note: For more information, refer to K5670: Overview of adaptive
connection reaping (11.5.x and earlier) and K14813: Detecting and
mitigating DoS/DDoS attacks (11.4.x - 12.x).</p>
</li>
<li><p class="first">TM.RejectUnmatched</p>
<p>By default, the TM.RejectUnmatched BigDB variable is set to true,
and the BIG-IP system sends a TCP RST packet in response to a
non-SYN packet that matches a virtual server address and port or
self IP address and port, but does not match an established
connection. The BIG-IP system also sends a TCP RST packet in
response to a packet that matches a virtual server address, or self
IP address, but specifies an invalid port. The TCP RST packet is
sent on the client side of the connection, and the source IP address
of the reset is the relevant BIG-IP LTM object address or self IP
address for which the packet was destined. If TM.RejectUnmatched is
set to false, the system silently drops unmatched packets.</p>
</li>
<li><p class="first">TM.MaxRejectRate</p>
<p>The TM.MaxRejectRate BigDB variable can reduce the effects of a
denial-of-service (DoS) attack by allowing you to limit the number
of TCP RSTs or ICMP unreachable packets that the BIG-IP system sends
in response to incoming connections that cannot be matched with
virtual server connections. The default value for the
TM.MaxRejectRate db key is 250 TCP RSTs or 250 ICMP unreachable
packets, per second.</p>
<p>Note: For more information, refer to K13151: Configuring the rate at
which the BIG-IP system issues TCP RSTs or ICMP unreachable packets
(11.x - 13.x).</p>
</li>
</ul>
<p>Virtual servers:</p>
<ul>
<li><p class="first">Virtual server connection limits</p>
<p>When a virtual server connection limit is configured, and the
maximum number of concurrent connections is exceeded for the virtual
server, the BIG-IP system sends a TCP RST packet in response to
connection attempts. The TCP RST packet is sent on the client side
of the connection, and the source IP address of the reset is the
relevant virtual server IP address.</p>
</li>
<li><p class="first">Reject virtual servers</p>
<p>A Reject virtual server always sends a TCP RST packet in response to
a connection attempt. The TCP RST packet is sent on the client side
of the connection, and the source IP address of the reset is the
relevant virtual server IP address.</p>
<p>Note: For more information, refer to K8082: Overview of TCP
connection setup for BIG-IP LTM virtual server types.</p>
</li>
</ul>
<p>Pools:</p>
<ul>
<li><p class="first">No available pool members</p>
<p>When all pool members are unavailable due to being disabled, forced
offline, or down, the BIG-IP RST behavior varies slightly depending
on the virtual server type. If the virtual server references a TCP
profile (Standard virtual server type), the system allows the
three-way TCP handshake to complete before sending the TCP RST to
the client. If the virtual server references a FastL4 profile, the
system sends a TCP RST packet in response to a connection attempt.
The TCP RST packet is sent on the client side of the connection, and
the source IP address of the reset is the relevant virtual server IP
address.</p>
</li>
<li><p class="first">Pool member or node connection limits</p>
<p>When a pool member or node connection limit is configured, and the
maximum number of concurrent connections is exceeded for the pool
member or node, the BIG-IP system resets the connection attempt. The
TCP RST packet is sent on the client side of the connection, and the
source IP address of the reset is the relevant virtual server IP
address.</p>
<p>Note: For more information, refer to K9849: The BIG-IP system sends
a TCP RST packet when the system reaches a pool member or node
connection limit.</p>
</li>
</ul>
<p>Profiles:</p>
<ul>
<li><p class="first">Protocol profile idle timeouts (if the Reset On Timeout setting is
enabled)</p>
<p>The BIG-IP system tracks connection flows by adding an entry to the
connection table. When the connection flow becomes idle, the BIG-IP
system starts a timer and closes the connection with a TCP RST
packet when the connection reaches the idle session timeout. The TCP
RST packet is sent on the client and server side of the connection,
and the source IP address of the reset is the relevant virtual
server IP address. If the connection flow is associated with
multiple profiles that specify different idle session timeout
values, the connection will be closed when the idle time reaches the
smaller value.</p>
<p>Note: For more information, refer to K7606: Overview of BIG-IP idle
session time-outs and K7166: Changing the idle timeout for a
protocol profile.</p>
</li>
<li><p class="first">Maximum Segment Retransmission</p>
<p>The BIG-IP LTM system resets TCP connections after sending eight
retransmissions for a connection. The TCP RST packet is sent on the
client side of the connection, and the source IP address of the
reset is the relevant virtual server IP address.</p>
<p>Note: For more information, refer to K14813: Detecting and
mitigating DoS/DDoS attacks (11.4.x - 12.x) and K7381: The BIG-IP
resets TCP connections after sending eight retransmissions for a
connection.</p>
</li>
<li><p class="first">Maximum SYN Retransmissions</p>
<p>The BIG-IP LTM system resets TCP connections after sending three SYN
retransmissions for a connection. The TCP RST packet is sent on the
client side of the connection, and the source IP address of the
reset is the relevant virtual server IP address.</p>
<p>Note: For more information, refer to K14813: Detecting and
mitigating DoS/DDoS attacks (11.4.x - 12.x), and K10372: BIG-IP LTM
resets TCP connections after sending three SYN retransmissions for a
connection.</p>
</li>
</ul>
<p>SNATs:</p>
<ul>
<li><p class="first">Unacknowledged SYN requests for SNAT objects</p>
<p>The BIG-IP LTM system terminates a SNAT flow with a TCP RST packet
after processing three unacknowledged SYN requests for the
connection.</p>
<p>Note: For more information, refer to K7829: Nascent SNAT connections
are reset when the retransmission backoff time exceeds the TCP
Handshake Timeout.</p>
</li>
<li><p class="first">Idle connection timeouts for SNAT objects</p>
<p>When a SNAT connection flow becomes idle and reaches the idle
session timeout, the BIG-IP system closes the connection with a TCP
RST packet.</p>
<p>Note: For more information, refer to K7606: Overview of BIG-IP idle
session time-outs.</p>
</li>
<li><p class="first">SNAT port exhaustion</p>
<p>A SNAT supports approximately 64,000 concurrent connections per
destination IP. A high volume of requests can exceed the 64,000
connection limit and result in TCP port exhaustion.</p>
<p>Note: For more information, refer to K7820: Overview of SNAT features.</p>
<p>Note: Connections processed by a SNAT object are also frequently
processed by a virtual server object. The source address of the TCP RST
packet will vary depending on whether the connection is processed by a
SNAT object alone, or whether the connection is also processed by a
virtual server.</p>
</li>
</ul>
<p>Monitors:</p>
<ul>
<li><p class="first">BIG-IP health monitors</p>
<p>Certain BIG-IP monitors may use a TCP RST packet to close the
monitor connection when the remote service returns a prompt. For
example, the tcp monitor initiates a TCP connection to the remote
service. If the service returns a prompt after the connection is
established (for example, FTP or SSH), the tcp monitor considers the
service to be up, and sends a TCP RST packet to the service.</p>
<p>The following BIG-IP monitor types may use a TCP RST packet to close
the monitor connection quickly after receiving matched content:</p>
</li>
<li><p class="first">The tcp_half_open monitor performs a simple check on the pool
member service by sending a TCP SYN packet to the service port. When
the monitor receives the SYN-ACK packet from the pool member, the
monitor considers the service to be up, and sends a TCP RST packet to
the service instead of completing the three-way handshake. The TCP
RST packet is typically sent on the server side of the connection,
and the source IP address of the reset is the relevant self IP
address of the VLAN.</p>
</li>
<li><p class="first">The HTTP monitor may send TCP reset packets to close the monitor
connection as soon as the health check receive string is matched,
even if the BIG-IP system has not yet received the entire object that
was requested in the HTTP monitor send string. Closing the monitor
connection in this way saves BIG-IP system resources.</p>
</li>
</ul>
<p>iRules:</p>
<ul>
<li><p class="first">iRules commands</p>
<p>An iRule can be configured to close TCP connections using a TCP RST
packet. For example, the reject iRule command closes the TCP
connection by sending a TCP RST packet to the TCP peer, as
appropriate, for the protocol. The TCP RST packet is sent on the
client side of the connection, and the source IP address of the
reset is the relevant BIG-IP LTM object address with which the iRule
is associated.</p>
<p>Note: For more information, refer to the DevCentral site. A
DevCentral login is required to access this content.</p>
</li>
<li><p class="first">Improperly configured iRules</p>
<p>An iRule with proper syntax but improper logic can be saved but may
cause traffic to be reset.</p>
</li>
</ul>
<p>Packet filters:</p>
<ul>
<li><p class="first">Packet filter rules</p>
<p>A packet filter configured with an action of Reject for certain TCP
traffic will force the system to reject the packet, and send a TCP
RST packet to the sender.</p>
</li>
</ul>
<p><strong>Application Reset</strong></p>
<p>This situation also generates a lot of calls and, unfortunately, is
determined typically by process of elimination. In other words, there is
no other reason for the reset so it must have come from the application.
I hate saying that, but that really is the answer. If we look at the
network traffic and see no reason for TCP itself to have sent the reset,
such as the other examples above, then it must have been sent from the
application. As I mentioned in the first paragraph, this is perfectly
legitimate and may even be desirable. This is a common practice in an
application that is making a large number of short-lived TCP
connections. Such an application can cause port exhaustion on the server
due to so many ports being in a Time Wait state. However, application
developers need to understand why the Time Wait state exists before just
resetting all connections.</p>
<p>Note: It is possible to look at the code for an application and
see if it is performing a Winsock function close (socket). If this
is done on a connection where data has been set, then this will
generate the Reset. You can also see this in Winsock logging. If
this function is called on a TCP connection where only the Three Way
Handshake has been completed, but no data has been sent, it will
result in the graceful close of the connection using Fin frames.</p>
<p><strong>Dropped packets</strong></p>
<p>A dropped packet on a network can cause a overhead on your network. It
is likely that if a packet is dropped more than one packet will have to
be resent. This is caused when network fragmentation occurs. As a
network interface is placing packets on the wire it is following an MTU
size limit for each packet. If the operating system is sending data to
the network that is in a way that is larger than the MTU size the
interface will break it up into packets that will fit the MTU. So when
one packet is lost it must resend all the packets for that data not just
the one lost packet.</p>
<p><strong>Retransmits</strong></p>
<p>A retransmit at a TCP level will likely mean that the TCP session data
has to be resent and if there is also fragmentation occurring at the
network layer it will compound the issue as mentioned in the dropped
packet section above.</p>
<p>ICMP Errors</p>
<p>ICMP Errors can add to an already taxed network. If you are under an
ICMP DOS attack the ICMP errors will add to the overhead that has to be
processed.</p>
<p>ICMP messages are typically used for diagnostic or control purposes or
generated in response to errors in IP operations (as specified in RFC
1122). ICMP errors are directed to the source IP address of the
originating packet.</p>
<p>ICMP error messages contain a data section that includes the entire IPv4
header, plus the first eight bytes of data from the IPv4 packet that
caused the error message. The ICMP packet is then encapsulated in a new
IPv4 packet.</p>
<hr class="docutils" />
<p><strong>CMP Demotion</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/14000/200/sol14248.html?sr=46608046">https://support.f5.com/kb/en-us/solutions/public/14000/200/sol14248.html?sr=46608046</a></p>
<p>CMP should not be confused with Symmetric Multi-Processing (SMP). SMP
architecture is used in multiple operating systems. SMP operates by
allowing operating systems and software applications that are optimized
for SMP to use the multiple processors that are available to the
operating system. SMP performs this operation by spreading multiple
threads across multiple processors, which allows for faster processing
and more efficient use of system resources, as multiple threads can be
processed simultaneously instead of waiting in a queue to be processed.
CMP uses a similar approach to leverage multiple processing units by
spawning a separate instance of the TMM process on each processing unit
that is available to the system. While SMP may be used for any process,
CMP processing is available only to the BIG-IP TMM process for the sole
purpose of providing more dedicated resources to manage load balanced
traffic. With multiple TMM instances simultaneously processing traffic,
system performance is enhanced, and traffic management capacity is
expanded.</p>
<p>Even if CMP is enabled on a virtual server, the BIG-IP system demotes a
virtual server with incompatible features from CMP processing. This
means it will run slower due to the CMP feature being turned off.</p>
<p>If the virtual server has been demoted, the CMP Mode line of the TMSH
show ltm virtual &lt;virtual_server_name&gt; command reports none, disable,
or single to indicate that CMP has been demoted for the virtual server.</p>
<p>The command output would appear similar to the following example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">---------------------------------------------------------</span>
<span class="go">Ltm::Virtual Server: CMP_vip</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">Status</span>
<span class="go">Availability : available</span>
<span class="go">State : enabled</span>
<span class="go">Reason : The virtual server is available</span>
<span class="go">CMP : enabled</span>
<span class="go">CMP Mode : single</span>
<span class="go">Destination : 10.11.10.212:80</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-11-given-a-trace-and-necessary-supporting-documentation-determine-the-root-cause-of-an-application-problem">
<h2>Objective - 2.11 Given a trace and necessary supporting documentation, determine the root cause of an application problem<a class="headerlink" href="#objective-2-11-given-a-trace-and-necessary-supporting-documentation-determine-the-root-cause-of-an-application-problem" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.11 - Analyze a tcpdump to identify application or configuration problems.</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/1000/800/sol1893.html">https://support.f5.com/kb/en-us/solutions/public/1000/800/sol1893.html</a></p>
<p><strong>Packet trace analysis</strong></p>
<p>To determine application issues, you will need to be familiar with how
to gather packet traces and what the output should look like when
applications are performing correctly. Since applications pass through
the BIG-IP, a mis-configuration of the BIG-IP can cause an application
fail. But if an app is broken, it will still be broken regardless of how
it is accessed. This can only be learned by doing captures of working
and broken application traffic.</p>
<p>When you are troubleshooting scenarios and looking at packet traces you
may need to recognize that the application is not working due to
anything from of the network design to application requirements.</p>
<p><strong>Network Design example</strong></p>
<p>Settings related to SNAT may need to be enabled or disabled in the
BIG-IP flow. When SNAT is not enabled the client IP address will remain
the same on both sides of the flow. When SNAT is enabled the client IP
address will be changed to an IP address controlled by the BIG-IP.</p>
<p>If the application server does not have a return path in the network to
the original requesting client IP address, that passes through the
BIG-IP, then SNAT will need to be enabled to force the return traffic
back to the BIG-IP. This will allow the BIG-IP to respond to the
original request from the client correctly.</p>
<p><strong>Application Requirements</strong></p>
<p>Recognizing applications issues can be harder than recognizing most
network issues. It might not be hard to recognize an SSL handshake issue
as described in section 2.09 but an issue with persistence may be hard
to see in a packet capture. If you have feedback from the testers or
users defining the issue you may be able to more quickly pinpoint that
the issue revolves around persistence. If you are looking at a trace you
may have to look past the TCP and into the HTTP headers and or payload
to find the issue.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-12-given-a-trace-and-necessary-supporting-documentation-determine-a-solution-to-an-application-problem">
<h2>Objective - 2.12 Given a trace and necessary supporting documentation, determine a solution to an application problem<a class="headerlink" href="#objective-2-12-given-a-trace-and-necessary-supporting-documentation-determine-a-solution-to-an-application-problem" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.12 - Analyze a tcpdump to identify application or configuration problems</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/1000/800/sol1893.html">https://support.f5.com/kb/en-us/solutions/public/1000/800/sol1893.html</a></p>
<p><strong>Packet trace analysis</strong></p>
<p>To determine application issues, you will need to be familiar with how
to gather packet traces and what the output should look like when
applications are performing correctly. Since applications pass through
the BIG-IP, a mis-configuration of the BIG-IP can cause an application
fail. But if an app is broken, it will still be broken regardless of how
it is accessed. This can only be learned by doing captures of working
and broken application traffic.</p>
<p>When you are troubleshooting scenarios and looking at packet traces you
may need to recognize that the application is not working due to
anything from of the network design to application requirements.</p>
<p><strong>Network Design example</strong></p>
<p>Settings related to SNAT may need to be enabled or disabled in the
BIG-IP flow. When SNAT is not enabled the client IP address will remain
the same on both sides of the flow. When SNAT is enabled the client IP
address will be changed to an IP address controlled by the BIG-IP.</p>
<p>If the application server does not have a return path in the network to
the original requesting client IP address, that passes through the
BIG-IP, then SNAT will need to be enabled to force the return traffic
back to the BIG-IP. This will allow the BIG-IP to respond to the
original request from the client correctly.</p>
<p><strong>Application Requirements</strong></p>
<p>Recognizing applications issues can be harder than recognizing most
network issues. It might not be hard to recognize an SSL handshake issue
as described in section 2.09 but an issue with persistence may be hard
to see in a packet capture. If you have feedback from the testers or
users defining the issue you may be able to more quickly pinpoint that
the issue revolves around persistence. If you are looking at a trace you
may have to look past the TCP and into the HTTP headers and or payload
to find the issue.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-13-given-a-scenario-determine-from-where-the-protocol-analyzer-data-should-be-collected">
<h2>Objective - 2.13 Given a scenario, determine from where the protocol analyzer data should be collected<a class="headerlink" href="#objective-2-13-given-a-scenario-determine-from-where-the-protocol-analyzer-data-should-be-collected" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.13 - Explain how to decrypt SSL traffic for protocol analysis</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/10000/200/sol10209.html">https://support.f5.com/kb/en-us/solutions/public/10000/200/sol10209.html</a></p>
<p><strong>ssldump</strong></p>
<p>The Secure Socket Layer (SSL) protocol is used to encrypt sensitive data
for transmission on the Internet. If a BIG-IP LTM system is contributing
to a technical issue, it may be helpful to decrypt the application data
to better understand the issue. The ssldump utility is an SSL/TLS
network protocol analyzer, which identifies TCP connections from a
chosen packet trace or network interface and attempts to interpret them
as SSL/TLS traffic. When the ssldump utility identifies SSL/TLS traffic,
it decodes the records and displays them in text to standard output. If
provided with the private key that was used to encrypt the connections,
the ssldump utility may also be able to decrypt the connections and
display the application data traffic.</p>
<p>You can use the ssldump utility to examine, decrypt, and decode
SSL-encrypted packet streams managed by the BIG-IP system. The ssldump
utility can act on packet streams real-time as they traverse the system,
or on a packet capture file saved in the libpcap format, such as that
produced by the tcpdump utility. Although it is possible for the ssldump
utility to decode and display live traffic real-time as it traverses the
BIG-IP system, it is rarely the most effective method to examine the
voluminous and complex output of the ssldump utility. Capturing the
target traffic to a file using the tcpdump utility, then decoding the
file using the ssldump utility offers a better opportunity to examine
the traffic in detail.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.13 - Explain how to recognize the different causes of slow traffic (e.g., drops, RSTs, retransmits, ICMP errors, demotion from CMP)</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/9000/800/sol9812.html?sr=46608010">https://support.f5.com/kb/en-us/solutions/public/9000/800/sol9812.html?sr=46608010</a></p>
<p><strong>Causes of slow traffic</strong></p>
<p>There can be many different reasons for slow traffic or poor network
performance and to end users of a network-based application it all seems
the same “The network is slow”. Any of these topics or combination of
topics can cause the network to seem slow.</p>
<hr class="docutils" />
<p><strong>Resets</strong></p>
<p><a class="reference external" href="http://blogs.technet.com/b/networking/archive/2009/08/12/where-do-resets-come-from-no-the-stork-does-not-bring-them.aspx">http://blogs.technet.com/b/networking/archive/2009/08/12/where-do-resets-come-from-no-the-stork-does-not-bring-them.aspx</a></p>
<p>The BIG-IP system will close a TCP connection by sending a TCP RST
packet to a client and/or pool member under a variety of circumstances.
Depending on the specific BIG-IP configuration object, you can adjust
the BIG-IP system reset behavior from the default behavior by using the
Configuration utility or command line.</p>
<p>There are many reasons for resets, but some common causes of resets are
as follows:</p>
<p>Global settings:</p>
<ul>
<li><p class="first">Adaptive Reaping</p>
<p>To prevent SYN flood attacks, and to preserve memory, the BIG-IP
system can prevent new connections by sending a TCP RST packet to
the client when memory usage increases beyond the reaper high-water
mark setting. The TCP RST packet is sent on the client side of the
connection, and the source IP address of the reset is the relevant
BIG-IP LTM object IP address for which the SYN request was destined.</p>
<p>Note: For more information, refer to K5670: Overview of adaptive
connection reaping (11.5.x and earlier) and K14813: Detecting and
mitigating DoS/DDoS attacks (11.4.x - 12.x).</p>
</li>
<li><p class="first">TM.RejectUnmatched</p>
<p>By default, the TM.RejectUnmatched BigDB variable is set to true,
and the BIG-IP system sends a TCP RST packet in response to a
non-SYN packet that matches a virtual server address and port or
self IP address and port, but does not match an established
connection. The BIG-IP system also sends a TCP RST packet in
response to a packet that matches a virtual server address, or self
IP address, but specifies an invalid port. The TCP RST packet is
sent on the client side of the connection, and the source IP address
of the reset is the relevant BIG-IP LTM object address or self IP
address for which the packet was destined. If TM.RejectUnmatched is
set to false, the system silently drops unmatched packets.</p>
</li>
<li><p class="first">TM.MaxRejectRate</p>
<p>The TM.MaxRejectRate BigDB variable can reduce the effects of a
denial-of-service (DoS) attack by allowing you to limit the number
of TCP RSTs or ICMP unreachable packets that the BIG-IP system sends
in response to incoming connections that cannot be matched with
virtual server connections. The default value for the
TM.MaxRejectRate db key is 250 TCP RSTs or 250 ICMP unreachable
packets, per second.</p>
<p>Note: For more information, refer to K13151: Configuring the rate at
which the BIG-IP system issues TCP RSTs or ICMP unreachable packets
(11.x - 13.x).</p>
</li>
</ul>
<p>Virtual servers:</p>
<ul>
<li><p class="first">Virtual server connection limits</p>
<p>When a virtual server connection limit is configured, and the
maximum number of concurrent connections is exceeded for the virtual
server, the BIG-IP system sends a TCP RST packet in response to
connection attempts. The TCP RST packet is sent on the client side
of the connection, and the source IP address of the reset is the
relevant virtual server IP address.</p>
</li>
<li><p class="first">Reject virtual servers</p>
<p>A Reject virtual server always sends a TCP RST packet in response to
a connection attempt. The TCP RST packet is sent on the client side
of the connection, and the source IP address of the reset is the
relevant virtual server IP address.</p>
<p>Note: For more information, refer to K8082: Overview of TCP
connection setup for BIG-IP LTM virtual server types.</p>
</li>
</ul>
<p>Pools:</p>
<ul>
<li><p class="first">No available pool members</p>
<p>When all pool members are unavailable due to being disabled, forced
offline, or down, the BIG-IP RST behavior varies slightly depending
on the virtual server type. If the virtual server references a TCP
profile (Standard virtual server type), the system allows the
three-way TCP handshake to complete before sending the TCP RST to
the client. If the virtual server references a FastL4 profile, the
system sends a TCP RST packet in response to a connection attempt.
The TCP RST packet is sent on the client side of the connection, and
the source IP address of the reset is the relevant virtual server IP
address.</p>
</li>
<li><p class="first">Pool member or node connection limits</p>
<p>When a pool member or node connection limit is configured, and the
maximum number of concurrent connections is exceeded for the pool
member or node, the BIG-IP system resets the connection attempt. The
TCP RST packet is sent on the client side of the connection, and the
source IP address of the reset is the relevant virtual server IP
address.</p>
<p>Note: For more information, refer to K9849: The BIG-IP system sends
a TCP RST packet when the system reaches a pool member or node
connection limit.</p>
</li>
</ul>
<p>Profiles:</p>
<ul>
<li><p class="first">Protocol profile idle timeouts (if the Reset On Timeout setting is
enabled)</p>
<p>The BIG-IP system tracks connection flows by adding an entry to the
connection table. When the connection flow becomes idle, the BIG-IP
system starts a timer and closes the connection with a TCP RST
packet when the connection reaches the idle session timeout. The TCP
RST packet is sent on the client and server side of the connection,
and the source IP address of the reset is the relevant virtual
server IP address. If the connection flow is associated with
multiple profiles that specify different idle session timeout
values, the connection will be closed when the idle time reaches the
smaller value.</p>
<p>Note: For more information, refer to K7606: Overview of BIG-IP idle
session time-outs and K7166: Changing the idle timeout for a
protocol profile.</p>
</li>
<li><p class="first">Maximum Segment Retransmission</p>
<p>The BIG-IP LTM system resets TCP connections after sending eight
retransmissions for a connection. The TCP RST packet is sent on the
client side of the connection, and the source IP address of the
reset is the relevant virtual server IP address.</p>
<p>Note: For more information, refer to K14813: Detecting and
mitigating DoS/DDoS attacks (11.4.x - 12.x) and K7381: The BIG-IP
resets TCP connections after sending eight retransmissions for a
connection.</p>
</li>
<li><p class="first">Maximum SYN Retransmissions</p>
<p>The BIG-IP LTM system resets TCP connections after sending three SYN
retransmissions for a connection. The TCP RST packet is sent on the
client side of the connection, and the source IP address of the
reset is the relevant virtual server IP address.</p>
<p>Note: For more information, refer to K14813: Detecting and
mitigating DoS/DDoS attacks (11.4.x - 12.x), and K10372: BIG-IP LTM
resets TCP connections after sending three SYN retransmissions for a
connection.</p>
</li>
</ul>
<p>SNATs:</p>
<ul>
<li><p class="first">Unacknowledged SYN requests for SNAT objects</p>
<p>The BIG-IP LTM system terminates a SNAT flow with a TCP RST packet
after processing three unacknowledged SYN requests for the
connection.</p>
<p>Note: For more information, refer to K7829: Nascent SNAT connections
are reset when the retransmission backoff time exceeds the TCP
Handshake Timeout.</p>
</li>
<li><p class="first">Idle connection timeouts for SNAT objects</p>
<p>When a SNAT connection flow becomes idle and reaches the idle
session timeout, the BIG-IP system closes the connection with a TCP
RST packet.</p>
<p>Note: For more information, refer to K7606: Overview of BIG-IP idle
session time-outs.</p>
</li>
<li><p class="first">SNAT port exhaustion</p>
<p>A SNAT supports approximately 64,000 concurrent connections per
destination IP. A high volume of requests can exceed the 64,000
connection limit and result in TCP port exhaustion.</p>
<p>Note: For more information, refer to K7820: Overview of SNAT
features.</p>
<p>Note: Connections processed by a SNAT object are also frequently
processed by a virtual server object. The source address of the TCP RST
packet will vary depending on whether the connection is processed by a
SNAT object alone, or whether the connection is also processed by a
virtual server.</p>
</li>
</ul>
<p>Monitors:</p>
<ul>
<li><p class="first">BIG-IP health monitors</p>
<p>Certain BIG-IP monitors may use a TCP RST packet to close the
monitor connection when the remote service returns a prompt. For
example, the tcp monitor initiates a TCP connection to the remote
service. If the service returns a prompt after the connection is
established (for example, FTP or SSH), the tcp monitor considers the
service to be up, and sends a TCP RST packet to the service.</p>
<p>The following BIG-IP monitor types may use a TCP RST packet to close
the monitor connection quickly after receiving matched content:</p>
</li>
<li><p class="first">The tcp_half_open monitor performs a simple check on the pool
member service by sending a TCP SYN packet to the service port. When
the monitor receives the SYN-ACK packet from the pool member, the
monitor considers the service to be up, and sends a TCP RST packet to
the service instead of completing the three-way handshake. The TCP
RST packet is typically sent on the server side of the connection,
and the source IP address of the reset is the relevant self IP
address of the VLAN.</p>
</li>
<li><p class="first">The HTTP monitor may send TCP reset packets to close the monitor
connection as soon as the health check receive string is matched,
even if the BIG-IP system has not yet received the entire object that
was requested in the HTTP monitor send string. Closing the monitor
connection in this way saves BIG-IP system resources.</p>
</li>
</ul>
<p>iRules:</p>
<ul>
<li><p class="first">iRules commands</p>
<p>An iRule can be configured to close TCP connections using a TCP RST
packet. For example, the reject iRule command closes the TCP
connection by sending a TCP RST packet to the TCP peer, as
appropriate, for the protocol. The TCP RST packet is sent on the
client side of the connection, and the source IP address of the
reset is the relevant BIG-IP LTM object address with which the iRule
is associated.</p>
<p>Note: For more information, refer to the DevCentral site. A
DevCentral login is required to access this content.</p>
</li>
<li><p class="first">Improperly configured iRules</p>
<p>An iRule with proper syntax but improper logic can be saved but may
cause traffic to be reset.</p>
</li>
</ul>
<p>Packet filters:</p>
<ul>
<li><p class="first">Packet filter rules</p>
<p>A packet filter configured with an action of Reject for certain TCP
traffic will force the system to reject the packet, and send a TCP
RST packet to the sender.</p>
</li>
</ul>
<p><strong>Application Reset</strong></p>
<p>This situation also generates a lot of calls and, unfortunately, is
determined typically by process of elimination. In other words, there is
no other reason for the reset so it must have come from the application.
I hate saying that, but that really is the answer. If we look at the
network traffic and see no reason for TCP itself to have sent the reset,
such as the other examples above, then it must have been sent from the
application. As I mentioned in the first paragraph, this is perfectly
legitimate and may even be desirable. This is a common practice in an
application that is making a large number of short-lived TCP
connections. Such an application can cause port exhaustion on the server
due to so many ports being in a Time Wait state. However, application
developers need to understand why the Time Wait state exists before just
resetting all connections.</p>
<p>Note: It is possible to look at the code for an application and
see if it is performing a Winsock function close (socket). If this
is done on a connection where data has been set, then this will
generate the Reset. You can also see this in Winsock logging. If
this function is called on a TCP connection where only the Three Way
Handshake has been completed, but no data has been sent, it will
result in the graceful close of the connection using Fin frames.</p>
<p><strong>Dropped packets</strong></p>
<p>A dropped packet on a network can cause a overhead on your network. It
is likely that if a packet is dropped more than one packet will have to
be resent. This is caused when network fragmentation occurs. As a
network interface is placing packets on the wire it is following an MTU
size limit for each packet. If the operating system is sending data to
the network that is in a way that is larger than the MTU size the
interface will break it up into packets that will fit the MTU. So when
one packet is lost it must resend all the packets for that data not just
the one lost packet.</p>
<p><strong>Retransmits</strong></p>
<p>A retransmit at a TCP level will likely mean that the TCP session data
has to be resent and if there is also fragmentation occurring at the
network layer it will compound the issue as mentioned in the dropped
packet section above.</p>
<p>ICMP Errors</p>
<p>ICMP Errors can add to an already taxed network. If you are under an
ICMP DOS attack the ICMP errors will add to the overhead that has to be
processed.</p>
<p>ICMP messages are typically used for diagnostic or control purposes or
generated in response to errors in IP operations (as specified in RFC
1122). ICMP errors are directed to the source IP address of the
originating packet.</p>
<p>ICMP error messages contain a data section that includes the entire IPv4
header, plus the first eight bytes of data from the IPv4 packet that
caused the error message. The ICMP packet is then encapsulated in a new
IPv4 packet.</p>
<hr class="docutils" />
<p><strong>CMP Demotion</strong></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/solutions/public/14000/200/sol14248.html?sr=46608046">https://support.f5.com/kb/en-us/solutions/public/14000/200/sol14248.html?sr=46608046</a></p>
<p>CMP should not be confused with Symmetric Multi-Processing (SMP). SMP
architecture is used in multiple operating systems. SMP operates by
allowing operating systems and software applications that are optimized
for SMP to use the multiple processors that are available to the
operating system. SMP performs this operation by spreading multiple
threads across multiple processors, which allows for faster processing
and more efficient use of system resources, as multiple threads can be
processed simultaneously instead of waiting in a queue to be processed.
CMP uses a similar approach to leverage multiple processing units by
spawning a separate instance of the TMM process on each processing unit
that is available to the system. While SMP may be used for any process,
CMP processing is available only to the BIG-IP TMM process for the sole
purpose of providing more dedicated resources to manage load balanced
traffic. With multiple TMM instances simultaneously processing traffic,
system performance is enhanced, and traffic management capacity is
expanded.</p>
<p>Even if CMP is enabled on a virtual server, the BIG-IP system demotes a
virtual server with incompatible features from CMP processing. This
means it will run slower due to the CMP feature being turned off.</p>
<p>If the virtual server has been demoted, the CMP Mode line of the TMSH
show ltm virtual &lt;virtual_server_name&gt; command reports none, disable,
or single to indicate that CMP has been demoted for the virtual server.</p>
<p>The command output would appear similar to the following example:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">---------------------------------------------------------</span>
<span class="go">Ltm::Virtual Server: CMP\_vip</span>
<span class="go">---------------------------------------------------------</span>
<span class="go">Status</span>
<span class="go">Availability : available</span>
<span class="go">State : enabled</span>
<span class="go">Reason : The virtual server is available</span>
<span class="go">CMP : enabled</span>
<span class="go">CMP Mode : single</span>
<span class="go">Destination : 10.11.10.212:80</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.13 - Chose the appropriate protocol analyzer for troubleshooting a given problem (e.g., Wireshark, tcpdump, ssldump)</strong></p>
<p><strong>Which packet capture tool should be used to resolve an application issue?</strong></p>
<p>There are many different tools that can do a packet capture. Some are a
physical bump in the wire (e.g. protocol analyzer on a tap port)
capturing data as it flows through the device, while others are software
running on a node (e.g. Wireshark on a PC, tcpdump on a Linux system)
that promiscuously (promiscuous network interface is required) listens
on the wire for traffic flow. You can also do a capture on the BIG-IP
using tcpdump. Doing a capture on the BIG-IP will create overhead on the
system and may negatively affect system performance of a device which is
controlling network flow to production systems. So, choosing how and
where to capture data is very important.</p>
<p>The rules are simple. You need to gather the packet capture where the
problem is occurring on the network, when the problem is happening. A
packet capture, no matter the tool used to gather it, is going to show
you the conversations between the nodes. Some tools are easier than
others to use to filter and read conversations. Some gathering tools
like tcpdump provide only the ability to read the capture (-r).
Wireshark is one of the better tools to use due to strong filtering
capabilities.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.13 - Identify application issues based on a protocol analyzer trace</strong></p>
<p>To determine application issues, you will need to be familiar with how
to gather packet traces and what the output should look like when
applications are performing correctly. Since applications pass through
the BIG-IP, a mis-configuration of the BIG-IP can cause an application
fail. But if an app is broken, it will still be broken regardless of how
it is accessed. This can only be learned by doing captures of working
and broken application traffic.</p>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.13 - Explain how SNAT and OneConnect effect protocol analyzer traces</strong></p>
<p><strong>SNAT and OneConnect</strong></p>
<p>SNAT and OneConnect can have a direct impact on your captures since they
both modify the typical connection flows in the system. SNAT does a
Source Network Address Translation thus if configured a source IP
addresses may change from one side of the full proxy to the other.
OneConnect is essentially TCP multiplexing and when enabled will attempt
to reuse existing established connections for the subsequent
connections. Both of these settings can cause you to get lost when
trying to follow connections from client to server and back again.</p>
<hr class="docutils" />
<p><a class="reference external" href="https://support.f5.com/csp/article/K13637">https://support.f5.com/csp/article/K13637</a></p>
<p>Beginning in BIG-IP 11.2.0, you can use the p interface modifier with
the n modifier to capture traffic with TMM information for a specific
flow and its related peer flow. The p modifier allows you to capture a
specific traffic flow through the BIG-IP system from end to end, even
when the configuration uses a secure network address translation (SNAT)
or OneConnect. For example, the following command searches for traffic
to or from client 10.0.0.1 on interface 0.0:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tcpdump -ni <span class="m">0</span>.0:nnnp -s0 -c <span class="m">100000</span> -w /var/tmp/capture.dmp host <span class="m">10</span>.0.0.1
</pre></div>
</div>
<p>After tcpdump identifies a related flow, the flow is marked in TMM, and
every subsequent packet in the flow (on both sides of the BIG-IP system)
is written to the capture file.</p>
<p>Important: This modifier produces large amounts of data and can cause
significant resource utilization. This additional resource demand may
cause poor performance or a system failure if the BIG-IP system is at
high resource utilization. Use this modifier only with very specific
filters.</p>
<p>Note: This modifier continues to produce flow information for the life
of the connection. Subsequent tcpdump captures reveal flow information
from previous tcpdump captures using the :p modifier if the connection
is still active. To clear flow information from previous use, run the
tcpdump command without the :p modifier using a filter that matches no
information in the flow and ensure some traffic has been received by the
BIG-IP system for the flow.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-14-given-a-trace-identify-monitor-issues">
<h2>Objective - 2.14 Given a trace, identify monitor issues<a class="headerlink" href="#objective-2-14-given-a-trace-identify-monitor-issues" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.14 - Explain how to capture and interpret monitor traffic using protocol analyzer</strong></p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K12531">https://support.f5.com/csp/article/K12531</a></p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K411">https://support.f5.com/csp/article/K411</a></p>
<p><strong>Capture and Interpret Monitor Traffic</strong></p>
<p>Health monitors originate from the non-floating self IP addresses of
both the active and standby BIG-IP systems. This means when you need
capture monitor traffic from a BIG-IP to another device you will need to
filter for traffic originating from the non-floating self IP addresses.</p>
<p>The following capture would gather http based monitor traffic:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tcpdump -s0 src host &lt;non-floating self IP address&gt; and dst port <span class="m">80</span>
</pre></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.14 - Explain how to obtain needed input and output data to create the monitors</strong></p>
<p>You can use external tools to try to gather the information necessary to
configure a monitor. For example, a tool like CURL will allow you to
make a http based URL request to a server and will display the requested
webpage data in text format. This way you know the http request string
to use in the monitor and know what comes back and can choose what part
of the response to put in the receive string of the monitor.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl http://www.f5.com

&lt;html&gt;
&lt;head&gt;&lt;title&gt;301 Moved Permanently&lt;/title&gt;&lt;/head&gt;
&lt;body <span class="nv">bgcolor</span><span class="o">=</span><span class="s2">&quot;white&quot;</span>&gt;
&lt;center&gt;&lt;h1&gt;301 Moved Permanently&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;CloudFront&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<hr class="docutils" />
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-1/15.html">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-1/15.html</a></p>
<p><strong>Creating Monitors</strong></p>
<p>You create a custom monitor when the values defined in a pre-configured
monitor do not meet your needs, or no pre-configured monitor exists for
the type of monitor you are creating.</p>
<p>When you create a custom monitor, you use the BIG-IP Configuration
utility or a command line utility to: give the monitor a unique name,
specify a monitor type, and, if a monitor of that type already exists,
import settings and their values from the existing monitor. You can then
change the values of any imported settings.</p>
<p>You must base each custom monitor on a monitor type. When you create a
monitor, the BIG-IP Configuration utility displays a list of monitor
types. To specify a monitor type, simply choose the one that corresponds
to the service you want to check. For example, if you want to want to
create a monitor that checks the health of the HTTP service on a pool,
you choose HTTP as the monitor type.</p>
<p>If you want to check more than one service on a pool or pool member (for
example HTTP and HTTPS), you can associate more than one monitor on that
pool or pool member.</p>
<p>Checking services is not the only reason for implementing a monitor. If
you want to verify only that the destination IP address is alive, or
that the path to it through a transparent node is alive, use one of the
simple monitors, icmp or tcp_echo. Or, if you want to verify TCP only,
use the monitor tcp.</p>
<p>Monitor destinations</p>
<p>By default, the value for the Alias Address setting in the monitors is
set to the wildcard * Addresses, and the Alias Service Port setting is
set to the wildcard * Ports. This value causes the monitor instance
created for a pool, pool member, or node to take that node’s address or
address and port as its destination. You can, however, replace either or
both wildcard symbols with an explicit destination value, by creating a
custom monitor. An explicit value for the Alias Address and/or Alias
Service Port setting is used to force the instance destination to a
specific address and/or port which might not be that of the pool, pool
member, or node.</p>
<p>The ECV monitor types HTTP, HTTPS, and TCP include the settings Send
String and Receive String for the send string and receive expression,
respectively.</p>
<p>The most common Send String value is GET /, which retrieves a default
HTML page for a web site. To retrieve a specific page from a web site,
you can enter a Send String value that is a fully qualified path name:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;GET /www/support/customer\_info\_form.html&quot;</span>
</pre></div>
</div>
<p>The Receive String value is the text string that the monitor looks for
in the returned resource. The most common Receive String values contain
a text string that is included in a particular HTML page on your site.
The text string can be regular text, HTML tags, or image names.</p>
<p>The sample Receive String value below searches for a standard HTML tag:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;&lt;HEAD&gt;&quot;</span>
</pre></div>
</div>
<p>You can also use the default null Receive String value [“”]. In this
case, any content retrieved is considered a match. If both the Send
String and Receive String fields are left empty, only a simple
connection check is performed.</p>
<p>For HTTP and FTP monitor types, you can use the special values GET or
hurl in place of Send String and Receive String values. For FTP monitors
specifically, the GET value should specify the full path to the file to
retrieve.</p>
<p>Transparent and Reverse modes</p>
<p>The normal and default behavior for a monitor is to ping the destination
pool, pool member, or node by an unspecified route, and to mark the node
up if the test is successful. However, with certain monitor types, you
can specify a route through which the monitor pings the destination
server. You configure this by specifying the Transparent or Reverse
setting within a custom monitor.</p>
<p>Transparent setting</p>
<p>Sometimes it is necessary to ping the aliased destination through a
transparent pool, pool member, or node. When you create a custom monitor
and set the Transparent setting to Yes, Local Traffic Manager forces the
monitor to ping through the pool, pool member, or node with which it is
associated (usually a firewall) to the pool, pool member, or node. (That
is, if there are two firewalls in a load balancing pool, the destination
pool, pool member, or node is always pinged through the pool, pool
member, or node specified; not through the pool, pool member, or node
selected by the load balancing method.) In this way, the transparent
pool, pool member, or node is tested: if there is no response, the
transparent pool, pool member, or node is marked as down.</p>
<p>Common examples are checking a router, or checking a mail or FTP server
through a firewall. For example, you might want to check the router
address 10.10.10.53:80 through a transparent firewall 10.10.10.101:80.
To do this, you create a monitor called http_trans in which you specify
10.10.10.53:80 as the monitor destination address, and set the
Transparent setting to Yes. Then you associate the monitor http_trans
with the transparent pool, pool member, or node.</p>
<p>This causes the monitor to check the address 10.10.10 53:80 through
10.10.10.101:80. (In other words, the BIG-IP system routes the check of
10.10.10.53:80 through 10.10.10.101:80.) If the correct response is not
received from 10.10.10.53:80, then 10.10.10.101:80 is marked down.</p>
<p>Reverse setting</p>
<p>With the Reverse setting set to Yes, the monitor marks the pool, pool
member, or node down when the test is successful. For example, if the
content on your web site home page is dynamic and changes frequently,
you may want to set up a reverse ECV service check that looks for the
string “Error”. A match for this string means that the web server was
down.</p>
<p>By default, when a monitor detects that a resource (that is, a node or a
pool member) is unavailable, the BIG-IP system marks the resource as
down and routes traffic to the next appropriate resource as dictated by
the active load balancing method. When the monitor next determines that
the resource is available again, the BIG-IP system marks the resource as
up and immediately considers the resource to be available for load
balancing connection requests. While this process is appropriate for
most resources, there are situations where you want to manually
designate a resource as available, rather than allow the BIG-IP system
to do that automatically. You can manually designate a resource as
available by configuring the Manual Resume setting of the monitor.</p>
<p>For example, consider a monitor that you assigned to a resource to track
the availability of an HTML file, index.html, for a web site. During the
course of a business day, you decide that you need to restart the system
that hosts the web site. The monitor detects the restart action and
informs the BIG-IP system that the resource is now unavailable. When the
system restarts, the monitor detects that the index.html file is
available, and begins sending connection requests to the web site.
However, the rest of the web site might not be ready to receive
connection requests. Consequently, the BIG-IP system sends connection
requests to the web site before the site can respond effectively.</p>
<p>To prevent this problem, you can configure the Manual Resume setting of
the monitor. When you set the Manual Resume setting to Yes, you ensure
that the BIG-IP system considers the resource to be unavailable until
you manually enable that resource.</p>
<p>Resumption of connections</p>
<p>If you have a resource (such as a pool member or node) that a monitor
marked as down, and the resource has subsequently become available
again, you must manually re-enable that resource if the monitor’s Manual
Resume setting is set to Yes. Manually re-enabling the resource allows
the BIG-IP system to resume sending connections to that resource.</p>
<p>The procedure for manually re-enabling a resource varies depending on
whether the resource is a pool, a pool member, or a node.</p>
<p>The Time Until Up feature</p>
<p>By default, the BIG-IP system marks a pool member or node as up
immediately upon receipt of the first correct response to a ping
command.</p>
<p>The Time Until Up feature provides a way to adjust the default behavior.
This feature allows the system to delay the marking of a pool member or
node as up for some number of seconds after receipt of the first correct
response. The purpose of this feature is to ensure that the monitor
marks the pool member or node as up only after the pool member or node
has consistently responded correctly to the BIG-IP system during the
defined time period. With this feature, you ensure that a pool member or
node that is available only momentarily, after sending one correct
response, is not marked as up.</p>
<p>A Time Until Up value of 0 causes the default behavior. When the Time
Until Up value is a non-0 value, the BIG-IP system marks a pool member
or node as up only when all pool member or node responses during the
Time Until Up period are correct.</p>
<p>Dynamic ratio load balancing</p>
<p>You can configure Dynamic Ratio load balancing for pools that consist of
RealNetworks RealServer servers, Microsoft Windows servers equipped with
Windows Management Instrumentation (WMI), or any server equipped with an
SNMP agent such as the UC Davis SNMP agent or Windows 2000 Server SNMP
agent.</p>
<p>To implement Dynamic Ratio load balancing for these types of servers,
BIG-IP Local Traffic Manager provides a special monitor plug-in file and
a performance monitor for each type of server. The exception is a server
equipped with an SNMP agent. In this case, Local Traffic Manager
provides the monitor only; no special plug-in file is required for a
server running an SNMP agent.</p>
<p>You must install the monitor plug-in on each server to be monitored, and
you must create a performance monitor that resides on the BIG-IP system.
Once you have created a monitor, the monitor communicates directly with
the server plug-in.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
<div class="section" id="objective-2-15-given-a-monitor-issue-determine-an-appropriate-solution">
<h2>Objective - 2.15 Given a monitor issue, determine an appropriate solution<a class="headerlink" href="#objective-2-15-given-a-monitor-issue-determine-an-appropriate-solution" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<p><strong>2.15 - Determine appropriate monitor and monitor timing based on application and server limitations</strong></p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K12531">https://support.f5.com/csp/article/K12531</a></p>
<p><strong>Monitor timing</strong></p>
<p>Interval/timeout ratio</p>
<p>You must configure an appropriate interval/timeout ratio for simple
monitors. In most cases, the timeout value should be equal to three
times the interval value, plus one. For example, the default ratio is
5/16 (three times 5 plus one equals 16). Verify that the ratio is
properly defined.</p>
<p>There are some applications that may require different timers and some
of those settings may be shown in the following article under the
details of each specific type of monitor</p>
<hr class="docutils" />
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-monitors-reference-11-5-0/3.html">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-monitors-reference-11-5-0/3.html</a></p>
<p><strong>Application appropriate monitor</strong></p>
<p>The following tables describe the functional categories of health
monitors, and list the available BIG-IP monitors within each category.
Unless otherwise specified, each monitor is used by Local Traffic
Manager, Global Traffic Manager, and Link Controller.</p>
<p>Address-check monitors</p>
<p>An address-check monitor is a simple monitor that pings an IP address to
verify that the address can be reached on a network.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Address-check monitor</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>Gateway ICMP</strong></td>
<td>Uses Internet Control Message Protocol (ICMP) to make a simple resource check. The check is successful if the monitor receives a response to an ICMP_ECHO datagram.</td>
</tr>
<tr class="row-odd"><td><strong>ICMP</strong></td>
<td>Makes a simple node check. The check is successful if the monitor receives a response to an ICMP_ECHO datagram.</td>
</tr>
<tr class="row-even"><td><strong>TCP Echo</strong></td>
<td>Verifies Transmission Control Protocol (TCP) connections. The check is successful if the BIG-IP system receives a response to a TCP Echo message.</td>
</tr>
</tbody>
</table>
<p>Service-check monitors</p>
<p>A service-check monitor determines whether a service is available by
opening a connection to an IP address and port.</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="95%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Service-check monitor</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>Diameter</strong></td>
<td>Monitors servers running the Diameter authentication service. After configuring a Diameter monitor, associate the monitor with a load balancing pool. The BIG-IP system then attempts to establish a TCP connection with a server in the pool. After successfully establishing a connection, the Diameter monitor sends a Capabilities-Exchanging-Request (CER) message to the server. The monitor then waits to receive a Capabilities-Exchanging-Answer (CEA) message, as well as a result code of DIAMETER_SUCCESS (2001).</td>
</tr>
<tr class="row-odd"><td><strong>FirePass</strong></td>
<td>Checks the health of FirePass systems.</td>
</tr>
<tr class="row-even"><td><strong>Inband</strong></td>
<td>Performs passive monitoring as part of client requests. This monitor, when acting as a client, attempts to connect to a pool member. If the pool member does not respond to a connection request after a user-specified number of tries within a user-specified period, the monitor marks the pool member as down. After the monitor has marked the pool member as down, and after a user-specified period has passed, the monitor again tries to connect to the pool member (if so configured).</td>
</tr>
<tr class="row-odd"><td><strong>NNTP</strong></td>
<td>Checks the status of Usenet News traffic. The check is successful if the monitor retrieves a newsgroup identification line from the server. An <strong>NNTP</strong> monitor requires a newsgroup name (for example, alt.cars.mercedes) and, if necessary, a user name and password.</td>
</tr>
<tr class="row-even"><td><strong>MSSQL</strong></td>
<td>Performs service checks on Microsoft SQL Server-based services such as Microsoft SQL Server versions 6.5 and 7.0.</td>
</tr>
<tr class="row-odd"><td><strong>MySQL</strong></td>
<td>Checks the status of a MySQL database server. The check is successful if the monitor is able to connect to the server, log in as the indicated user, and log out.</td>
</tr>
<tr class="row-even"><td><strong>Oracle</strong></td>
<td>Checks the status of an Oracle database server. The check is successful if the monitor is able to connect to the server, log in as the indicated user, and log out.</td>
</tr>
<tr class="row-odd"><td><strong>POP3</strong></td>
<td>Checks the status of Post Office Protocol (POP) traffic. The check is successful if the monitor is able to connect to the server, log in as the indicated user, and log out. A <strong>POP3</strong> monitor requires a user name and password.</td>
</tr>
<tr class="row-even"><td><strong>PostgreSQL</strong></td>
<td>Checks the status of a PostgreSQL database server. The check is successful if the monitor is able to connect to the server, log in as the indicated user, and log out.</td>
</tr>
<tr class="row-odd"><td><strong>RADIUS</strong></td>
<td>Checks the status of Remote Access Dial-in User Service (RADIUS) servers. The check is successful if the server authenticates the requesting user. A RADIUS monitor requires a user name, a password, and a shared secret string for the code number.</td>
</tr>
<tr class="row-even"><td><strong>RADIUS Accounting</strong></td>
<td>Checks the status of Remote Access Dial-in User Service (RADIUS) accounting servers. A RADIUS Accounting monitor requires a user name and a shared secret string for the code number.</td>
</tr>
<tr class="row-odd"><td><strong>RPC</strong></td>
<td>Checks the availability of specific programs that reside on a remote procedure call (RPC) server. This monitor uses the <strong>rpcinfo</strong> command to query the RPC server and verify the availability of a given program.</td>
</tr>
<tr class="row-even"><td><strong>SASP</strong></td>
<td><p class="first">Verifies the availability of a IBM Group Workload Manager. This monitor uses the Server/Application State Protocol (SASP) to communicate with the Group Workload Manager. The monitor queries the Group Workload Manager for information on the current weights of each managed resource. These weights determine which resource currently provides the best response time. When the monitor receives this information from the Group Workload Manager (GWM), it configures the dynamic ratio option for the resources, allowing the BIG-IP system to select the most appropriate resource to respond to a connection request.</p>
<p class="last">Note: When you assign an <strong>SASP</strong> monitor, the monitor initially marks the resources as down. This change in status occurs because the GWM might not yet have information pertaining to its resources. As soon as the monitor receives the results of its query, it changes the status as needed. In most configurations, the monitor receives these results within a few seconds.</p>
</td>
</tr>
<tr class="row-odd"><td><strong>SIP</strong></td>
<td>Checks the status of SIP Call-ID services. By default, this monitor type issues an SIP OPTIONS request to a server device. However, you can use alternative protocols instead: <strong>TCP</strong>, <strong>UDP</strong>, <strong>TLS</strong>, and <strong>SIPS</strong> (that is, Secure SIP).</td>
</tr>
<tr class="row-even"><td><strong>SMB</strong></td>
<td>Verifies the availability of a Server Message Block/Common Internet File System (SMB/CIFS) server. Use this monitor to check the availability of the server as a whole, the availability of a specific service on the server, or the availability of a specific file used by a service.</td>
</tr>
<tr class="row-odd"><td><strong>SOAP</strong></td>
<td>Tests a web service based on the Simple Object Access Protocol (SOAP). The monitor submits a request to a SOAP-based web service, and optionally, verifies a return value or fault.</td>
</tr>
<tr class="row-even"><td><strong>TCP Half Open</strong></td>
<td>Monitors the associated service by sending a TCP SYN packet to the service. As soon as the monitor receives the SYN-ACK packet, the monitor marks the service as up.</td>
</tr>
<tr class="row-odd"><td><strong>UDP</strong></td>
<td>Verifies the User Datagram Protocol (UDP) service by attempting to send UDP packets to a pool, pool member, or virtual server and receiving a reply.</td>
</tr>
</tbody>
</table>
<p>Content-check monitors</p>
<p>A content-check monitor sends a command to a server and examines that
server’s response to ensure that it is serving appropriate content.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Content-check monitor</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>DNS</strong></td>
<td>Checks the status of Domain Name Server (DNS) servers, by sending a specific string, and verifying receipt of that string. The check is successful if the DNS server responds with a specified string within a specified period.</td>
</tr>
<tr class="row-odd"><td><strong>HTTP</strong></td>
<td><p class="first">Checks the status of Hypertext Transfer Protocol (HTTP) traffic. Like a TCP monitor, an HTTP monitor attempts to receive specific content from a web page, and unlike a TCP monitor, might send a user name and password.</p>
<p class="last">Note: An HTTP monitor can monitor Outlook® Web Access (OWA) in Microsoft® Exchange Server 2007 and Microsoft® SharePoint® 2007 web sites that require NT LAN Manager (NTLM) authentication. NTLM authentication requires a send string that complies with HTTP/1.1, a user name, and a password.</p>
</td>
</tr>
<tr class="row-even"><td><strong>HTTPS</strong></td>
<td><p class="first">Checks the status of Hypertext Transfer Protocol Secure (HTTPS) traffic. An HTTPS monitor attempts to receive specific content from a web page protected by SSL security. The check is successful when the content matches the <strong>Receive String</strong> value.</p>
<p class="last">Note: An HTTP monitor can monitor Outlook® Web Access (OWA) in Microsoft® Exchange Server 2007 and Microsoft® SharePoint® 2007 web sites that require NT LAN Manager (NTLM) authentication. NTLM authentication requires a send string that complies with HTTP/1.1, a user name, and a password.</p>
</td>
</tr>
<tr class="row-odd"><td><strong>https_443</strong></td>
<td>Checks the status of Hypertext Transfer Protocol Secure (HTTPS) traffic, by using port 443.</td>
</tr>
<tr class="row-even"><td><strong>LDAP</strong></td>
<td>Checks the status of Lightweight Directory Access Protocol (LDAP) servers. A check is successful if entries are returned for the base and filter specified. An LDAP monitor requires a user name, a password, and base and filter strings.</td>
</tr>
<tr class="row-odd"><td><strong>Scripted</strong></td>
<td>Generates a simple script that reads a file that you create. The file contains send and expect strings to specify lines that you want to send or that you expect to receive.</td>
</tr>
<tr class="row-even"><td><strong>SMTP</strong></td>
<td>Checks the status of Simple Mail Transport Protocol (SMTP) servers. This monitor type checks only that the server is up and responding to commands. The check is successful if the mail server responds to the standard <strong>SMTP HELO</strong> and <strong>QUIT</strong> commands.</td>
</tr>
<tr class="row-odd"><td><strong>TCP</strong></td>
<td>Verifies the Transmission Control Protocol (TCP) service by attempting to receive specific content from a resource. The check is successful when the content matches the <strong>Receive String</strong> value.</td>
</tr>
<tr class="row-even"><td><strong>WAP</strong></td>
<td>Monitors Wireless Application Protocol (WAP) servers. The common usage for the <strong>WAP</strong> monitor is to specify the <strong>Send String</strong> and <strong>Receive String</strong> settings only. The <strong>WAP</strong> monitor functions by requesting a URL and finding the string in the <strong>Receive String</strong> setting in the data returned by the URL response.</td>
</tr>
</tbody>
</table>
<p>Path-check monitors</p>
<p>A path-check monitor determines whether traffic can flow through a given
device to an arbitrary endpoint. The monitor sends a packet through the
network device, or to a remote server, to verify that the traffic can
actually pass through the network device, and not just to the device.</p>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Path-check monitor</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>Gateway ICMP</strong></td>
<td>Uses Internet Control Message Protocol (ICMP) to make a simple resource check. The check is successful if the monitor receives a response to an ICMP_ECHO datagram.</td>
</tr>
<tr class="row-odd"><td><strong>ICMP</strong></td>
<td>Makes a simple node check. The check is successful if the monitor receives a response to an ICMP_ECHO datagram.</td>
</tr>
<tr class="row-even"><td><strong>TCP Echo</strong></td>
<td>Verifies Transmission Control Protocol (TCP) connections. The check is successful if the BIG-IP system receives a response to a TCP Echo message.</td>
</tr>
</tbody>
</table>
<p>Application-check monitors</p>
<p>An application-check monitor is typically a custom monitor or external
monitor that tests a specific application. For example, an FTP monitor
connects, logs in by using a user ID and password, changes to a
specified directory, and requests a specific file. This monitor succeeds
when the file is received.</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="95%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Application-check monitor</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>BIG-IP</strong></td>
<td>Gathers metrics and statistics information that the Local Traffic Manager acquires through the monitoring of its own resources. Typically, it is sufficient to assign only the BIG-IP monitor to a Local Traffic Manager. When you want to verify the availability of a specific resource managed by the Local Traffic Manager, F5 recommends that you first assign the appropriate monitor to the resource through the Local Traffic Manager, and then assign a BIG-IP monitor to the Local Traffic Manager through the Global Traffic Manager. This configuration provides the most efficient means of tracking resources managed by a BIG-IP system.</td>
</tr>
<tr class="row-odd"><td><strong>BIG-IP Link</strong></td>
<td>Gathers metrics and statistics information that the Link Controller™ acquires through the monitoring of its own resources. When you use the Global Traffic Manager in a network that contains a Link Controller, you must assign a BIG-IP Link monitor to the Link Controller. This monitor is automatically assigned to the Link Controller if you do not manually assign it.</td>
</tr>
<tr class="row-even"><td><strong>External</strong></td>
<td>Enables you to create your own monitor type.</td>
</tr>
<tr class="row-odd"><td><strong>FTP</strong></td>
<td>Attempts to download a specified file to the /var/tmp directory, and if the file is retrieved, the check is successful. Note that once the file has been successfully downloaded, the BIG-IP system does not save it.</td>
</tr>
<tr class="row-even"><td><strong>IMAP</strong></td>
<td>Checks the status of Internet Message Access Protocol (IMAP) traffic. An IMAP monitor is essentially a POP3 type of monitor with the addition of the Folder setting. The check is successful if the monitor is able to log into a server and open the specified mail folder.</td>
</tr>
<tr class="row-odd"><td><strong>Module Score</strong></td>
<td><p class="first">Enables global and local traffic management systems to load balance in a proportional manner to local traffic management virtual servers associated with the BIG-IP® Application Acceleration Manager and Application Security Manager™. When you configure a <strong>Module Score</strong> monitor, the local traffic management system uses SNMP to pull the gtm_score values from the downstream virtual servers and set the dynamic ratios on the associated upstream local traffic management pool members or nodes.</p>
<p>The <strong>Module Score</strong> monitor retrieves the gtm_score values from the virtual server and the gtm_vs_score values associated with the virtual server. Then, if a pool name is not specified, this monitor sets the dynamic ratio on the node that is associated with the virtual server.</p>
<p class="last">The BIG-IP system uses the lowest non-zero value of the gtm_vs_score values to set the dynamic ratio. If all gtm_vs_score values are zero, then the gtm_score value is used to set the dynamic ratios. If you specify a pool name in the monitor definition, then the dynamic ratio is set on the pool member.</p>
</td>
</tr>
<tr class="row-even"><td><strong>Virtual Location</strong></td>
<td>Optimizes end-user response time in environments with dynamic distribution of application resources across multiple data centers. When using the <strong>Virtual Location</strong> monitor, the BIG-IP sets the <strong>Priority Group</strong> value of all local pool members to <strong>2</strong> (a higher priority). When a member of a load balancing pool migrates to a remote data center the <strong>Virtual Location</strong> monitor lowers the members <strong>Priority Group</strong> value to <strong>1</strong> (a lower priority). This value adjustment results in subsequent connections being sent to local pool members only if available. If no local pool members are available, connections are sent to the remote pool member.</td>
</tr>
</tbody>
</table>
<p>Performance monitors</p>
<p>A performance monitor interacts with the server (as opposed to virtual
server) to examine the server load and to acquire information about the
condition of virtual servers.</p>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Performance monitor</strong></td>
<td><strong>Description</strong></td>
</tr>
<tr class="row-even"><td><strong>BIG-IP</strong></td>
<td><p class="first">Collects data from Global Traffic Manager and Local Traffic Manager. Typically, the Local Traffic Manager probes local pool members and provides the results to Global Traffic Manager.</p>
<p class="last">Note: When the BIG-IP monitor fails, all virtual servers for that Local Traffic Manager system are marked unavailable, regardless of the results of individual virtual server probes.</p>
</td>
</tr>
<tr class="row-odd"><td><strong>BIG-IP Link</strong></td>
<td>Gathers metrics and statistics information acquired through the monitoring of Global Traffic Manager or Link Controller resources.</td>
</tr>
<tr class="row-even"><td><strong>SNMP</strong></td>
<td>Checks the performance of a server that runs an SNMP agent to load balance to that server. A custom <strong>snmp_gtm</strong> import setting is assigned to servers that are not developed by F5.</td>
</tr>
<tr class="row-odd"><td><strong>SNMP DCA</strong></td>
<td>Checks the performance of a server running an SNMP agent such as UC Davis, for the purpose of load balancing traffic to that server. With this monitor you can define ratio weights for CPU, memory, and disk use.</td>
</tr>
<tr class="row-even"><td><strong>SNMP DCA Base</strong></td>
<td>Checks the performance of servers that are running an SNMP agent, such as UC Davis. However, you should use this monitor only when you want the load balancing destination to be based solely on user data, and not CPU, memory, or disk use.</td>
</tr>
<tr class="row-odd"><td><strong>Real Server</strong></td>
<td>Checks the performance of a node that is running the RealSystem Server data collection agent. The monitor then dynamically load balances traffic accordingly.</td>
</tr>
<tr class="row-even"><td><strong>WMI</strong></td>
<td><p class="first">Checks the performance of a node that is running the Windows Management Infrastructure (WMI) data collection agent, and then dynamically load balances traffic accordingly. Generally, you would use a WMI monitor with dynamic ratio load balancing.</p>
<p class="last">Note: When using the <strong>GetWinMediaInfo</strong> command with a WMI monitor, Microsoft® Windows Server® 2003 and Microsoft® Windows Server® 2008 require the applicable version of Windows Media® Services to be installed on each server.</p>
</td>
</tr>
</tbody>
</table>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
<p><strong>2.15 - Describe how to modify monitor settings to resolve monitor problems</strong></p>
<p><a class="reference external" href="https://support.f5.com/csp/article/K12531#3">https://support.f5.com/csp/article/K12531#3</a></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-monitors-reference-11-5-0/1.html">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-monitors-reference-11-5-0/1.html</a></p>
<p><a class="reference external" href="https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-0/14.html">https://support.f5.com/kb/en-us/products/big-ip_ltm/manuals/product/ltm-concepts-11-5-0/14.html</a></p>
<p><strong>Checking Monitor setting</strong></p>
<p>Verifying monitor settings</p>
<p>You must verify that monitor settings are properly defined for your
environment. F5 recommends that in most cases the timeout value should
be equal to three times the interval value, plus one. For example, the
default timeout/interval ratio is 5/16 (three times 5 plus one equals
16). This setting prevents the monitor from marking the node as down
before sending the last check.</p>
<p>Simple monitors</p>
<p>You can use a simple monitor to verify the status of a destination node
(or the path to the node through a transparent device). Simple monitors
only monitor the node address itself, not individual protocols,
services, or applications on a node. The BIG-IP system provides the
following pre-configured simple monitor types: gateway_icmp, icmp,
tcp_echo, tcp_half_open. If you determine that a simple monitor is
marking a node as down, you can verify the following settings:</p>
<ul>
<li><p class="first">Interval/timeout ratio</p>
<p>You must configure an appropriate interval/timeout ratio for simple
monitors. In most cases, the timeout value should be equal to three
times the interval value, plus one. For example, the default ratio
is 5/16 (three times 5 plus one equals 16). Verify that the ratio is
properly defined.</p>
</li>
<li><p class="first">Transparent</p>
<p>A transparent monitor uses a path through the associated node to
monitor the aliased destination. Verify that the destination target
device is reachable and configured properly for the monitor.</p>
</li>
</ul>
<p>Use the tcpdump command to capture monitor traffic.</p>
<p>If you are unable to determine the cause of a failing health monitor,
you may have to perform packet captures on the BIG-IP system. This is
discussed in Objective 2.14.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<iframe width="560" height="315" src="https://www.youtube.com/embed/3uDzuRZ47FA?rel=0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<div class="line-block">
<div class="line"><br /></div>
</div>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="module1.html" title="F5 301b Introduction" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="module3.html" title="Section 3 - Identify and Resolve LTM Device Issues" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>