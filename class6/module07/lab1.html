<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Load Balancing</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Load Balancing"/>
  <meta name="product" content="Unofficial - F5 Certification Exam Prep Material"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2020-08-13 09:31:44"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="Unofficial - F5 Certification Exam Prep Material" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Load Balancing &#8212; Unofficial - F5 Certification Exam Prep Material  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5_agility_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/CoveoFullSearch.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lab 8 - Networking" href="../module08/module08.html" />
    <link rel="prev" title="Lab 7 - Load Balancing and Pools" href="module07.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>Unofficial - F5 Certification Exam Prep Material  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Intro:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Getting Started with the F5 Certification Program 03/29/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 101 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class1/class1.html">F5 101 - App Delivery Fundamentals Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 201 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class2/class2.html">F5 201 - TMOS Administration Study Guide 11/01/19</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">F5 201 - TMOS Administration Labs 08/11/2020</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 202 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">F5 202 - Pre-Sales Fundamentals Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 301A Certification Exam Resources:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../class5/class5.html">F5 301A - BIG-IP LTM Specialist: Architect, Set-Up &amp; Deploy Study Guide 11/01/19</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../class6.html">F5 301A - BIG-IP LTM Specialist Labs 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 301B Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class7/class7.html">F5 301B - BIG-IP LTM Specialist: Maintain and Troubleshoot Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 302 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class9/class9.html">F5 302 - BIG-IP DNS Specialist Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 303 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class11/class11.html">F5 303 - BIG-IP ASM Specialist Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 304 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class13/class13.html">F5 304 - BIG-IP APM Specialist Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 401 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class15/class15.html">F5 401 - Security Solution Expert Study Guide 11/01/19</a></li>
</ul>
<p class="caption"><span class="caption-text">Unofficial - 402 Certification Exam Resources:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../class17/class17.html">F5 402 - Cloud Solutions Study Guide 11/01/19</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Load Balancing</a><ul>
<li><a class="reference internal" href="#ratio-load-balancing">Ratio Load Balancing</a></li>
<li><a class="reference internal" href="#priority-groups-lab">Priority Groups Lab</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simple-source-address-persistence">Simple (Source Address) Persistence</a></li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">Unofficial - F5 Certification Exam Prep Material</a>
              &gt; <a href="../class6.html">F5 301A - BIG-IP LTM Specialist Labs 11/01/19</a>
              &gt; <a href="module07.html">Lab 7 - Load Balancing and Pools</a>

          <span class="right">
             <a href="../../_sources/class6/module07/lab1.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/leifbr/f5-agility-labs-cert">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="load-balancing">
<h1>Load Balancing<a class="headerlink" href="#load-balancing" title="Permalink to this headline">¶</a></h1>
<div class="section" id="ratio-load-balancing">
<h2>Ratio Load Balancing<a class="headerlink" href="#ratio-load-balancing" title="Permalink to this headline">¶</a></h2>
<p>Go to Local <strong>Traffic &gt; Pools</strong> and select <strong>www_pool</strong> and then
<strong>Members</strong> from the top bar or you could click on the <strong>Members</strong> link
in the <strong>Pool List</strong> screen.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">When we created the pool, we performed all our configuration on
one page, but when we modify a pool the Resource information is under
the Members tab</p>
</div>
<p>Under <strong>Load Balancing</strong> section change the <strong>Load Balancing Method</strong> to <strong>Ratio (Member)</strong></p>
<p>In drop-down menu, notice most load balancing methods have two options, <strong>(Node)</strong> or <strong>(Member)</strong>.</p>
<p><em>Q1. What is the difference between Node and Member?</em></p>
<p>Select the first member in the pool <strong>10.1.20.11:80</strong> and change the
<strong>Ratio</strong> of the member to <strong>3</strong></p>
<p>Open the pool statistics and reset the statistics for <strong>www_pool</strong>.</p>
<p>Browse to <strong>http://10.1.10.100</strong> and refresh the browser screen several
times.</p>
<p><em>Q2. How many Total connections has each member taken? Is the ratio of
connections correct?</em></p>
<p>Now go back and put the pool back to <strong>Round Robin</strong> Load Balancing
Method</p>
<p>Reset the pool statistics and refresh the virtual server page several
times.</p>
<p><em>Q3. Does the ratio setting have any impact now?</em></p>
</div>
<div class="section" id="priority-groups-lab">
<h2>Priority Groups Lab<a class="headerlink" href="#priority-groups-lab" title="Permalink to this headline">¶</a></h2>
<p>Let’s look at priority groups. In this scenario we will treat the 10.1.20.13
server as if it was is in a disaster recovery site that can be reached
over a backhaul. You want to maintain at least two members in the pool for
redundancy and load.  You would traffic to be distributed t0 10.1.20.13 only during maintenance of one on the two primary servers or if one to the two other pool members fails.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remove any caching profiles from the www_vs virtual server (10.1.10.100).</p>
</div>
<p>Go to the <strong>www_pool</strong> <strong>Members</strong> section. Make sure the load
balancing method is <strong>Round Robin</strong>.</p>
<p>Set the <strong>Priority Group Activation</strong> to less than <strong>2</strong> Available
Members.</p>
<p>Select the pool members <strong>10.1.20.11</strong> and <strong>10.1.20.12</strong> and set their
<strong>Priority Group</strong> to <strong>10</strong>.</p>
<p>Review your settings and let’s see how load balancing reacts now.</p>
<p>Select the <strong>Statistics</strong> tab, reset the pool statistics, browse to
<strong>http://10.1.10.100</strong> and refresh several times.</p>
<p><em>Q1. Are all members taking connections? Which member isn’t taking
connections?</em></p>
<p>Let’s simulate a maintenance window or an outage by disabling a pool
member <strong>10.1.20.11:80</strong> in the highest priority group. This should
cause low priority group to be activated, since number of active members
in our high priority group has dropped below 2.</p>
<p><em>Q2. Is the lower priority group activated and taking connections?</em></p>
<p>Select a member in the <strong>Priority Group</strong> 10 and <strong>Disable</strong> that pool
member.</p>
<p>Once again, select <strong>Statistics</strong>, reset the pool statistics, browse to the
virtual server and see which pool members are taking hits now.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Once you are done testing re-enable your disabled pool member.</p>
</div>
</div>
</div>
<div class="section" id="simple-source-address-persistence">
<h1>Simple (Source Address) Persistence<a class="headerlink" href="#simple-source-address-persistence" title="Permalink to this headline">¶</a></h1>
<p>You have already seen cookie persistence at work, but if the client or
application (ie. ftp) does not support cookies you must use and
alternate method. The most common is Simple Persistence which is based
on the source IP address/network.</p>
<p>Verify your <strong>www_pool</strong> is using <strong>Round Robin</strong> load balancing and the
priority groups are disabled.</p>
<p>Browse to <strong>http://10.1.10.100</strong> and refresh several times. You should see
all 3 servers respond.</p>
<p>Go to <strong>Local Traffic &gt; Profiles</strong> and select the <strong>Persistence</strong> tab and
from the <strong>Persistence</strong> <strong>Profiles</strong> screen select the <strong>Create</strong>
button.</p>
<p>Create a new persistence profile named <strong>my-src-persist</strong> with a
<strong>Persistence Type</strong> of <strong>Source Address Affinity</strong> and set the
<strong>Timeout</strong> to <strong>120</strong> seconds and leave <strong>Mask: None</strong></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <strong>Mask: None</strong> defaults to <strong>255.255.255.255</strong> which means each new IP address will create a new
persistence record.</p>
</div>
<p>Now let’s attach the new persistence profile to the <strong>www_vs</strong> virtual
server.</p>
<div class="admonition hint">
<p class="first admonition-title">Hint</p>
<p class="last">When you create a Virtual Server everything is on a single page,
when you return to modified the Virtual Server the Properties and
Resources are on different pages.</p>
</div>
<p>Set the <strong>Default Persistence Profile</strong> to <strong>my-src-persist</strong>.</p>
<p>Test your Source Address Affinity persistence profile.</p>
<p>At this point you may want to open a second browser window to the BIG-IP
GUI.</p>
<p>Go to <strong>Statistics &gt; Module Statistic &gt; Local Traffic</strong> and select
<strong>Persistence Records</strong> from the <strong>Statistics Type</strong> menu.</p>
<p>In this window, you can watch you persistence records. You may want to
set <strong>Auto Refresh</strong> to 20 seconds.</p>
<p>In another BIG-IP GUI window go to <strong>www_pool</strong> and clear the member
statistics.</p>
<p>Browser to <strong>http://10.1.10.100</strong> and refresh several times.</p>
<p><em>Q1. How many members are taking traffic?</em></p>
<p><em>Q2. Check you Persists Records window, are the any persistence records?</em></p>
<p><em>Q3. Refresh you web page prior to the Age column reaching 120. What
happens?</em></p>
<p>While the persistence recorded is still active <strong>Disable</strong> the member
you are persisted too and refresh the browser page.</p>
<p><em>Q4. Could you access the web site? Why?</em></p>
<p>While the persistence recorded is still active, go the member specific
menu of the member you are persisted too and do a <strong>Force Offline</strong> and
refresh the browser page.</p>
<p><em>Q5. Could you access the web site? Why?</em></p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Re-enable the pool members before continuing.</p>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="module07.html" title="Lab 7 - Load Balancing and Pools" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../module08/module08.html" title="Lab 8 - Networking" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>